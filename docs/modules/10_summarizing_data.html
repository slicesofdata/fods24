<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gabriel I. Cook">
<meta name="dcterms.date" content="2024-02-29">

<title>PSYC166 - Summarizing Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://kit.fontawesome.com/78ddb093ea.js" crossorigin="anonymous"></script>


<link rel="stylesheet" href="../css/nav.css">
<link rel="stylesheet" href="../css/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title"><strong>PSYC166</strong></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text"><strong>Home</strong></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../syllabus/syllabus.html" rel="" target="" aria-current="page">
 <span class="menu-text"><strong>Syllabus</strong></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../modules/index.html" rel="" target="">
 <span class="menu-text"><strong>Modules</strong></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../project/index.html" rel="" target="">
 <span class="menu-text"><strong>Project</strong></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-slides" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text"><strong>Slides</strong></span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-slides">    
        <li>
    <a class="dropdown-item" href="../slides/01_intro_rstudio_rmarkdown_slides.html" rel="" target="">
 <span class="dropdown-text">R, RStudio, &amp; R Markdown</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/02_git_slides.html" rel="" target="">
 <span class="dropdown-text">Git and GitHub</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/03_functions_slides.html" rel="" target="">
 <span class="dropdown-text">Functions, Parameters, and Arguments</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/04_vectors_and_data_frames_slides.html" rel="" target="">
 <span class="dropdown-text">Vectors and Data Frames</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/05_importing_and_exporting_slides.html" rel="" target="">
 <span class="dropdown-text">Importing and Exporting Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/06_variables_cognition_slides.html" rel="" target="">
 <span class="dropdown-text">Variables, Measures of Cognition</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/07_manipulating_data_selecting_filtering_mutating_slides.html" rel="" target="">
 <span class="dropdown-text">Manipulating Data: Selecting, Filtering, &amp; Mutating</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/08_cognitive_data_slides.html" rel="" target="">
 <span class="dropdown-text">Cognitive Task Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/09_summarizing_data_slides.html" rel="" target="">
 <span class="dropdown-text">Grouping and Summarizing Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/09_summarizing_data_advanced_slides.html" rel="" target="">
 <span class="dropdown-text">Grouping and Summarizing Data (Advanced)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/10_cognitive_data_summary_slides.html" rel="" target="">
 <span class="dropdown-text">Summarizing Task Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/07_manipulating_data_pivoting_slides.html" rel="" target="">
 <span class="dropdown-text">Transforming Data: Pivoting</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/13_joining_data_slides.html" rel="" target="">
 <span class="dropdown-text">Joining Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/11_visualizing_data_slides.html" rel="" target="">
 <span class="dropdown-text">Visualizing Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/12_examining_relationships_slides.html" rel="" target="">
 <span class="dropdown-text">Examining Relationships</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/14_strings_and_factors_slides.html" rel="" target="">
 <span class="dropdown-text">Strings, Factors, and Regular Expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/16_models_project_slides.html" rel="" target="">
 <span class="dropdown-text">Discussing Models for Cognitive Tasks</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/17_linear_models_slides.html" rel="" target="">
 <span class="dropdown-text">Linear Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/18_eda_slides.html" rel="" target="">
 <span class="dropdown-text">Exploratory Data Analysis</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hw" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text"><strong>HW</strong></span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hw">    
        <li>
    <a class="dropdown-item" href="https://raw.githubusercontent.com/slicesofdata/fods24/main/homework/HW01.Rmd" rel="" target="">
 <span class="dropdown-text">HW 01</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://raw.githubusercontent.com/slicesofdata/fods24/main/homework/HW02.Rmd" rel="" target="">
 <span class="dropdown-text">HW 02</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://raw.githubusercontent.com/slicesofdata/fods24/main/homework/HW03.Rmd" rel="" target="">
 <span class="dropdown-text">HW 03</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://raw.githubusercontent.com/slicesofdata/fods24/main/homework/HW04.Rmd" rel="" target="">
 <span class="dropdown-text">HW 04</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://raw.githubusercontent.com/slicesofdata/fods24/main/homework/HW05.Rmd" rel="" target="">
 <span class="dropdown-text">HW 05</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://raw.githubusercontent.com/slicesofdata/fods24/main/homework/HW06.Rmd" rel="" target="">
 <span class="dropdown-text">HW 06</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://raw.githubusercontent.com/slicesofdata/fods24/main/homework/HW07.Rmd" rel="" target="">
 <span class="dropdown-text">HW 07</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://raw.githubusercontent.com/slicesofdata/fods24/main/homework/HW08.Rmd" rel="" target="">
 <span class="dropdown-text">HW 08</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://raw.githubusercontent.com/slicesofdata/fods24/main/homework/HW09.Rmd" rel="" target="">
 <span class="dropdown-text">HW 09</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://raw.githubusercontent.com/slicesofdata/fods24/main/homework/HW10.Rmd" rel="" target="">
 <span class="dropdown-text">HW 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text"><strong>Exercises</strong></span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-exercises">    
        <li>
    <a class="dropdown-item" href="../exercises/using_git_with_projects_exercise.Rmd" rel="" target="">
 <span class="dropdown-text">using_git_with_projects_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/functions_exercise.docx" rel="" target="">
 <span class="dropdown-text">functions_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/vectors_and_dataframes_exercise.docx" rel="" target="">
 <span class="dropdown-text">vectors_and_dataframes_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/imorting_and_exporting_exercise.docx" rel="" target="">
 <span class="dropdown-text">importing_and_exporting_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/transforming_exercise.docx" rel="" target="">
 <span class="dropdown-text">transforming_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/summarizing_exercise.docx" rel="" target="">
 <span class="dropdown-text">summarizing_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/visualizing_exercise.docx" rel="" target="">
 <span class="dropdown-text">visualizing_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/pivoting_exercise.docx" rel="" target="">
 <span class="dropdown-text">pivoting_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/strings_and_factors_exercise.docx" rel="" target="">
 <span class="dropdown-text">strings_and_factors_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/joining_exercise.docx" rel="" target="">
 <span class="dropdown-text">joining_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/linear_models_exercise.Rmd" rel="" target="">
 <span class="dropdown-text">linear_models_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/eda_exercise.docx" rel="" target="">
 <span class="dropdown-text">eda_exercise.docx</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-data" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text"><strong>Data</strong></span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-data">    
        <li>
    <a class="dropdown-item" href="https://github.com/slicesofdata/dataviz23/raw/main/data/cms-top-all-time-2023-swim.zip" rel="" target="">
 <span class="dropdown-text">cms-top-all-time-2023-swim.xlsx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/rfordatascience/tidytuesday" rel="" target="">
 <span class="dropdown-text">Fun Tidy Tuesday Data Sets</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://dcas.dmdc.osd.mil/dcas/app/home" rel="" target="">
 <span class="dropdown-text">Defense Casualty Analysis System (DCAS)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-cheatsheets" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text"><strong>Cheatsheets</strong></span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-cheatsheets">    
        <li>
    <a class="dropdown-item" href="../cheatsheets_and_tips/symbols.html" rel="" target="">
 <span class="dropdown-text">Symbols</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../cheatsheets/rmarkdown-2.0.pdf" rel="" target="">
 <span class="dropdown-text">RMarkdown</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf" rel="" target="">
 <span class="dropdown-text">Data Wrangling with {dplyr} and {tidyr}</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://rstudio.github.io/cheatsheets/html/quarto.html" rel="" target="">
 <span class="dropdown-text">Quarto (Publish and Share)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://rstudio.github.io/cheatsheets/html/strings.html" rel="" target="">
 <span class="dropdown-text">String Manipulation with {stringr}</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://rstudio.github.io/cheatsheets/html/data-import.html" rel="" target="">
 <span class="dropdown-text">Reading and Writing Data with {readr}</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../cheatsheets/Data_Science_With_R_Workflow.pdf" rel="" target="">
 <span class="dropdown-text">Data Science with RWorkflow</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://rstudio.github.io/cheatsheets/" rel="" target="">
 <span class="dropdown-text">More Cheatsheets From RStudio</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://images.datacamp.com/image/upload/v1676540721/Marketing/Blog/Quarto_Cheat_Sheet.pdf" rel="" target="">
 <span class="dropdown-text">Quarto Cheat Sheet (what Quarto Files Look Like)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../resources/tools.html" rel="" target="">
 <span class="menu-text"><strong>Other Tools</strong></span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/slicesofdata" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://gabrielcook.xyz" rel="" target="">
 <span class="menu-text">Me</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../modules/index.html">Modules</a></li><li class="breadcrumb-item"><a href="../modules/10_summarizing_data.html"><strong>Summarizing Data</strong></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Syllabus</strong></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../modules/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modules</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/01_installing_r_and_rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Installing R &amp; RStudio</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/01_introduction_to_r_rstudio_and_rmarkdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Introduction to RStudio and R Markdown</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/02_installing_and_setting_up_git_and_github.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Project Management 01: Installing and Setting Up Git and GitHub for R</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/02_using_git_and_github.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Project Management 02: R Projects, Git, and GitHub</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/04_functions_and_scripts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Functions, Arguments, and R scripts</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/05_vectors_and_data_frame_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Vectors and Data Frame Basics</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/06_importing_and_exporting_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Importing and Exporting Data Frames</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/07_variables_and_measures_of_cognition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Variables and Measures of Cognition</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/08_manipulating_data_selecting_filtering_mutating.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Selecting, Filtering, &amp; Mutating</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/09_working_with_cognitive_task_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Working with Cognitive Task Data</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/10_summarizing_data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><strong>Summarizing Data</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/11_summarizing_cognitive_task_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Summarizing Cognitive Task Data</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/12_manipulating_data_pivoting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Transforming Data Frames: Pivoting</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/13_visualizing_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Visualizing Data: {ggplot} and the grammar of graphics</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/14_joining_relational_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Joining Relational Data</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/15_joining_project_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Joining Project Data</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/16_examining_relationships_in_variables_of_cognition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Examining Relationships in Variables of Cognition</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/17_strings_and_factors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Strings, Factors, and Regular Expressions</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/18_linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Linear Models</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/19_exploratory_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Exploratory Data Analysis</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/summarizing_data_advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Summarizing Data: Using <code>across()</code> and Lists</strong></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../project/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project/01_project_team_roles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Team membership and roles</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project/02_project_midterm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Midterm presentation</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project/03_project_final.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Final Presentation</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project/04_project_report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Final Report</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project/05_project_tasks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Project Tasks</strong></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><strong>Overview</strong></a>
  <ul class="collapse">
  <li><a href="#readings-and-preparation" id="toc-readings-and-preparation" class="nav-link" data-scroll-target="#readings-and-preparation"><strong>Readings and Preparation</strong></a></li>
  <li><a href="#supplementary-readings" id="toc-supplementary-readings" class="nav-link" data-scroll-target="#supplementary-readings"><strong>Supplementary Readings</strong></a>
  <ul class="collapse">
  <li><a href="#to-do" id="toc-to-do" class="nav-link" data-scroll-target="#to-do"><strong>To Do</strong></a></li>
  </ul></li>
  <li><a href="#external-functions" id="toc-external-functions" class="nav-link" data-scroll-target="#external-functions"><strong>External Functions</strong></a></li>
  <li><a href="#libraries" id="toc-libraries" class="nav-link" data-scroll-target="#libraries"><strong>Libraries</strong></a></li>
  <li><a href="#load-libraries" id="toc-load-libraries" class="nav-link" data-scroll-target="#load-libraries"><strong>Load libraries</strong></a></li>
  </ul></li>
  <li><a href="#loading-data" id="toc-loading-data" class="nav-link" data-scroll-target="#loading-data"><strong>Loading Data</strong></a></li>
  <li><a href="#flavors-of-data" id="toc-flavors-of-data" class="nav-link" data-scroll-target="#flavors-of-data"><strong>Flavors of Data</strong></a></li>
  <li><a href="#data-organization-and-variability" id="toc-data-organization-and-variability" class="nav-link" data-scroll-target="#data-organization-and-variability"><strong>Data Organization and Variability</strong></a></li>
  <li><a href="#making-data" id="toc-making-data" class="nav-link" data-scroll-target="#making-data"><strong>Making Data</strong></a></li>
  <li><a href="#summarizing-data-using-dplyr" id="toc-summarizing-data-using-dplyr" class="nav-link" data-scroll-target="#summarizing-data-using-dplyr"><strong>Summarizing Data Using {dplyr}</strong></a>
  <ul class="collapse">
  <li><a href="#summarizing-as-a-constant" id="toc-summarizing-as-a-constant" class="nav-link" data-scroll-target="#summarizing-as-a-constant"><strong>Summarizing as a Constant</strong></a></li>
  <li><a href="#summarizing-with-a-function" id="toc-summarizing-with-a-function" class="nav-link" data-scroll-target="#summarizing-with-a-function"><strong>Summarizing with a Function</strong></a></li>
  <li><a href="#summarizing-with-multiple-functions" id="toc-summarizing-with-multiple-functions" class="nav-link" data-scroll-target="#summarizing-with-multiple-functions"><strong>Summarizing with Multiple Functions</strong></a></li>
  </ul></li>
  <li><a href="#aggregating-data" id="toc-aggregating-data" class="nav-link" data-scroll-target="#aggregating-data"><strong>Aggregating Data</strong></a></li>
  <li><a href="#aggregating-data-using-group_by" id="toc-aggregating-data-using-group_by" class="nav-link" data-scroll-target="#aggregating-data-using-group_by"><strong>Aggregating Data using <code>group_by()</code></strong></a>
  <ul class="collapse">
  <li><a href="#data-aggregation-using-group_by" id="toc-data-aggregation-using-group_by" class="nav-link" data-scroll-target="#data-aggregation-using-group_by"><strong>Data aggregation using <code>group_by()</code></strong></a></li>
  </ul></li>
  <li><a href="#comparing-mutate-with-summarize" id="toc-comparing-mutate-with-summarize" class="nav-link" data-scroll-target="#comparing-mutate-with-summarize"><strong>Comparing <code>mutate()</code> with <code>summarize()</code></strong></a>
  <ul class="collapse">
  <li><a href="#grouping-structure-of-group_by-and-mutate" id="toc-grouping-structure-of-group_by-and-mutate" class="nav-link" data-scroll-target="#grouping-structure-of-group_by-and-mutate"><strong>Grouping structure of <code>group_by()</code> and <code>mutate()</code></strong></a></li>
  <li><a href="#grouping-structure-of-group_by-and-summarize" id="toc-grouping-structure-of-group_by-and-summarize" class="nav-link" data-scroll-target="#grouping-structure-of-group_by-and-summarize"><strong>Grouping structure of <code>group_by()</code> and <code>summarize()</code></strong></a>
  <ul class="collapse">
  <li><a href="#group_by-and-summarize-with-.groups" id="toc-group_by-and-summarize-with-.groups" class="nav-link" data-scroll-target="#group_by-and-summarize-with-.groups"><strong><code>group_by()</code> and <code>summarize()</code> with <code>.groups</code></strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#more-on-grouping-structure" id="toc-more-on-grouping-structure" class="nav-link" data-scroll-target="#more-on-grouping-structure"><strong>More on Grouping Structure</strong></a>
  <ul class="collapse">
  <li><a href="#new-variable-columns" id="toc-new-variable-columns" class="nav-link" data-scroll-target="#new-variable-columns"><strong>New Variable Columns</strong></a>
  <ul class="collapse">
  <li><a href="#group_by-using-a-function" id="toc-group_by-using-a-function" class="nav-link" data-scroll-target="#group_by-using-a-function"><strong><code>group_by()</code> using a function</strong></a></li>
  </ul></li>
  <li><a href="#adddrop-grouping-variable-columns" id="toc-adddrop-grouping-variable-columns" class="nav-link" data-scroll-target="#adddrop-grouping-variable-columns"><strong>Add/drop Grouping Variable Columns</strong></a>
  <ul class="collapse">
  <li><a href="#retain-grouping" id="toc-retain-grouping" class="nav-link" data-scroll-target="#retain-grouping"><strong>Retain Grouping</strong></a></li>
  </ul></li>
  <li><a href="#why-care-about-grouping-structure" id="toc-why-care-about-grouping-structure" class="nav-link" data-scroll-target="#why-care-about-grouping-structure"><strong>Why Care About Grouping Structure</strong></a></li>
  </ul></li>
  <li><a href="#ungroup" id="toc-ungroup" class="nav-link" data-scroll-target="#ungroup"><strong>ungroup()</strong></a>
  <ul class="collapse">
  <li><a href="#variable-loss-with-summarize" id="toc-variable-loss-with-summarize" class="nav-link" data-scroll-target="#variable-loss-with-summarize"><strong>Variable loss with <code>summarize()</code></strong></a></li>
  <li><a href="#an-alternative-to-summarize-reframe" id="toc-an-alternative-to-summarize-reframe" class="nav-link" data-scroll-target="#an-alternative-to-summarize-reframe"><strong>An alternative to <code>summarize()</code>: <code>reframe()</code></strong></a></li>
  <li><a href="#retaining-distinct-data-after-mutate-using-distinct" id="toc-retaining-distinct-data-after-mutate-using-distinct" class="nav-link" data-scroll-target="#retaining-distinct-data-after-mutate-using-distinct"><strong>Retaining distinct data after <code>mutate()</code> using <code>distinct()</code></strong></a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><strong>Summary</strong></a></li>
  <li><a href="#advanced-summarizing-techniques" id="toc-advanced-summarizing-techniques" class="nav-link" data-scroll-target="#advanced-summarizing-techniques"><strong>Advanced Summarizing Techniques</strong></a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info"><strong>Session Info</strong></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><strong>Summarizing Data</strong></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Gabriel I. Cook </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 29, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1><strong>Overview</strong></h1>
<p>This module describes how to perform statistical transformations on data, including producing data summaries. In order to summarize data, we will again use <strong>{dplyr}</strong>. The way data are summarized will influence the way the data can be modeled as statistical models typically rely on understanding how predictor variables (independent) can account for variability in outcome variables (dependent). Eliminating variability in data by aggregating will affect the model you can use as well as the statistical inference draw from that statistical model. We will also discuss differences in grouping structure for <code>dplyr::mutate()</code> and <code>dplyr::summarize()</code> that will affect both variable computation and plot creation.</p>
<section id="readings-and-preparation" class="level3">
<h3 class="anchored" data-anchor-id="readings-and-preparation"><strong>Readings and Preparation</strong></h3>
<p><em>Before Class</em>: First, read to familiarize yourself with the concepts rather than master them. I will assume that you attend class with some level of basic understanding of concepts and working of functions. The goal of reading should be to understand and implement code functions as well as support your understanding and help your troubleshooting of problems. This cannot happen if you just read the content without interacting with it, however reading is absolutely essential to being successful during class time.</p>
<p><em>Class</em>: In class, some functions and concepts will be introduced and we will practice implementing code through exercises.</p>
</section>
<section id="supplementary-readings" class="level2">
<h2 class="anchored" data-anchor-id="supplementary-readings"><strong>Supplementary Readings</strong></h2>
<ul>
<li><a href="https://www.markhuberdatascience.org/_files/ugd/c2b9b6_543ea42a1ea64e32b4440b34ffd71635.pdf#page=81">Huber: Summaries</a></li>
</ul>
<section id="to-do" class="level3">
<h3 class="anchored" data-anchor-id="to-do"><strong>To Do</strong></h3>
<p>Read through the module. You can use the <code>R</code> console or open up an <code>R Markdown</code> (e.g., <code>.Rmd</code>) file to follow along interactively. If you instead prefer to simply read through the content so that you can understand the concepts without coding, that is fine too. You will practice using the concepts by working on activities. Reading the module will provide you with confidence working on those activities and prevent you from feeling lost while completing activities. Testing out some code may provide you more confidence.</p>
</section>
</section>
<section id="external-functions" class="level2">
<h2 class="anchored" data-anchor-id="external-functions"><strong>External Functions</strong></h2>
<p>Provided in class:</p>
<p><code>view_html()</code>: for viewing data frames in html format</p>
<p>You can access this remotely from:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"https://raw.githubusercontent.com/slicesofdata/fods24/main/r/functions/view_html.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Or from your own project work space by loading functions in <code>/r/functions</code>.</p>
</section>
<section id="libraries" class="level2">
<h2 class="anchored" data-anchor-id="libraries"><strong>Libraries</strong></h2>
<ul>
<li><strong>{dplyr}</strong> 1.1.4: for selecting, filtering, and mutating</li>
</ul>
</section>
<section id="load-libraries" class="level2">
<h2 class="anchored" data-anchor-id="load-libraries"><strong>Load libraries</strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="loading-data" class="level1">
<h1><strong>Loading Data</strong></h1>
<p>For this exercise, we will use some data from a 2023 CMS swim meet located at: “https://github.com/slicesofdata/dataviz23/raw/main/data/swim/cleaned-2023-CMS-Invite.csv”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>SWIM <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"https://github.com/slicesofdata/dataviz23/raw/main/data/swim/cleaned-2023-CMS-Invite.csv"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">show_col_types =</span> F</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="flavors-of-data" class="level1">
<h1><strong>Flavors of Data</strong></h1>
<p>Data come in many flavors. Data are collected on virtually everything you could think of. If there is a record of something, there is data. The stars, weather, television viewing, social media use, ocean currents, brand preference, parenting, symphonies, learning to code, graphical perceptual. When there is no record of something, you could collect data on it. For example, you could start logging the quantity of quality of advice your grandparents offer you. You may likely discover that advice changes based on their age. You may also consider logging the number to times you see your grandparents or your parents/guardians annually in order to determine approximately how many more times you will see them before they die, if they haven’t yet. In fact, some folks have already worked on this problem using actuarial tables. <a href="https://seeyourfolks.com/">Seeyourfolks</a> will provide a model estimate for you. See for yourself. Sure, it may be in error but all models have error. Nevertheless, prediction may change your life.</p>
</section>
<section id="data-organization-and-variability" class="level1">
<h1><strong>Data Organization and Variability</strong></h1>
<p>In some industries, data may be organized at a high level. For example, someone examining population growth may have data at a census level or an annual level. Someone who studies education may had data organized at a state level or county level. In other industries, data may be organized at a fine-grained level. For example, someone studying health outcomes may have data about individuals daily if daily health checks are part of a data-collection protocol. Someone who studies education may design a study to collect data, or obtain data, on daily-performance of students. Even further, their data may contain repeated measurements of specific topics (e.g., 10 different addition problems rather than one). Similarly, someone studying some aspect of human cognition may have high-level data like overall accuracy and total time needed to complete the task or they might have data at a low level containing trial-level accuracy and reaction timed data for each item.</p>
<p>Depending the organization of data and its level of granularity, one may be limited to a set of statistical models to examine. Because variability in data plays a significant role in testing models, the absence of variability will prevent modeling using statistical techniques that require that variability. For example, if your data set contains only one value for a country, you are likely limited to models that allow for comparisons or associations across countries or across time. For example, you could examine data to understand how population growth for a single country changes over time or you could examine population growth in one country compares to one or more than one country. Using the educational example, one could examine changes in a state over time or one could examine states to one another. By contrast, if you have daily data per student for a variety of topics, you have variability in data to examine at a variety of levels. You could examine how an individual’s performance changes across time in general or specifically for a specific topic. You can also examine how the individual performs on one type of task relative to another. You could also examine changes over time in performance on one task compared with changes over time for other tasks. Stepping up the hierarchy, you could compare performance of individuals across teachers, teacher’s sections, schools, school districts, counties, states, etc. because there is variability in the data to try to understand.</p>
<p>Although the data structure is typically conceived from top to bottom, which lower levels <em>nested</em> under higher levels, I will present the opposite order to prevent you reading from the bottom up.</p>
<pre><code>Daily Performance
- on an item type (e.g., 4 + 17)
-- on a task (e.g., addition)
--- for a person (e.g, Bill)
---- in a teacher's class (e.g., Mrs. Collins, Section 1)
----- in a school (e.g., Robert D. Wilson)
------ in a district (e.g., Western Wayne)
------- in a country (e.g., Wayne)
-------- in a state (e.g., Pennsylvania)
--------- in a country (e.g., United States of America)</code></pre>
<p>The structure at all these levels means that you can perform more complex models like linear-mixed models/hierarchical linear modeling. The variability in the data at all these levels allows you to account for the variability in ways you cannot if you only have top-level data. When you have the variability, you can examine for effect like random effects or fixed effects, which are not applicable to simpler linear models. To the extent that teachers in District A teach differently or motivate students differently from those teachers in District B, you could examine the data for these differences and account for them statistically (hold them constant as if teachers were the same) at higher levels of the data. In fact, that repeated-measures ANOVA model you are taught in your statistics class is not be appropriate for data with repeated measurements under different conditions because two individuals who with the same average performance may differ in their variability. For example, two students answer the subtraction problem (14 - 7) on average in 10.0 seconds across 5 instances. Mildred is consistent and answers it between 8 and 12 seconds. Tilford, however, answers with a range of 5 to 20 seconds. Although performance time is equated, the variability represents something very different in ability.</p>
</section>
<section id="making-data" class="level1">
<h1><strong>Making Data</strong></h1>
<p>We will work with a tiny data frame containing data for performance scores from students in schools in districts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="ot">&lt;-</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Student =</span> <span class="fu">c</span>(<span class="st">"Jim"</span>, <span class="st">"Sally"</span>, <span class="st">"June"</span>, <span class="st">"Mildred"</span>, <span class="st">"Tilford"</span>, <span class="st">"Beavis"</span>, <span class="st">"Herman"</span>, <span class="st">"Peppa"</span>, <span class="st">"Kay"</span>, <span class="st">"Jake"</span>, <span class="st">"Name Missing"</span>),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Score  =</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">85</span>, <span class="dv">79</span>, <span class="dv">80</span>, <span class="dv">81</span>, <span class="dv">91</span>, <span class="dv">89</span>, <span class="dv">60</span>, <span class="dv">65</span>, <span class="dv">67</span>, <span class="dv">65</span>), </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">School =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"E"</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">District =</span> <span class="fu">c</span>(<span class="st">"West"</span>, <span class="st">"West"</span>, <span class="st">"West"</span>, <span class="st">"West"</span>, <span class="st">"East"</span>, <span class="st">"East"</span>, <span class="st">"East"</span>, <span class="st">"North"</span>, <span class="st">"North"</span> , <span class="st">"North"</span>, <span class="st">"North"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can see that the performance for all students is on average, for example, if you didn’t know where they went to school. We would take only the mean.</p>
</section>
<section id="summarizing-data-using-dplyr" class="level1">
<h1><strong>Summarizing Data Using {dplyr}</strong></h1>
<p>However, there are many ways to summarize data. To introduce data summary techniques using <strong>{dplyr}</strong>, we will use <code>dplyr::summarise()</code> or <code>dplyr::summarize()</code> to summarize the data in the data frame. The <code>summarize()</code> (or <code>summarise()</code>) function works similar to <code>mutate()</code> insofar as it creates variables but it differs insofar as the data frame returned from <code>summarize()</code> contains only the variable(s) referenced in as part of that summary process. Importantly, <code>summarize()</code> will be performed based on some functions called immediately prior to <code>summarize()</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>   .data, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>   ..., </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">.by =</span> <span class="cn">NULL</span>, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>   <span class="at">.groups =</span> <span class="cn">NULL</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Key Parameters/Arguments:</strong></p>
<ul>
<li><code>.data</code>: a data frame</li>
<li><code>...</code>: name-value pairs of variable names and functions for the summary operation</li>
</ul>
<section id="summarizing-as-a-constant" class="level2">
<h2 class="anchored" data-anchor-id="summarizing-as-a-constant"><strong>Summarizing as a Constant</strong></h2>
<p>When piping code, the data frame will be inherited; the parameter and argument can be omitted. You will need to pass the expressions for the summary, however. Like <code>mutate()</code> The expression will require a variable name as well as a value or function.</p>
<p>Although <code>summarize()</code> can create variables like <code>mutate()</code>, it does so by grouping the data in some way. We will cover using <code>summarize()</code> with <code>group_by()</code> to group data but for now, you can see grouping happens automatically, making <code>summarize()</code> a different function than <code>mutate()</code>. The functions serve different purposes. A good rule of thumb for remembering the differences is that <code>mutate()</code> is used to add column variables to a data frame to make it bigger and <code>summarize()</code> is used to reduce the data frame by summarizing the data within it.</p>
<p>If we assign a variable name a value, we see that the data frame that is returned is now reduced to a single row. Specifically, the default operation is that <code>summarize()</code> groups all rows of the data frame together.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">my_new_var =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  my_new_var
1          1</code></pre>
</div>
</div>
<p>Clearly, this is a ridiculous summary of the data. Let’s do something that makes more sense.</p>
</section>
<section id="summarizing-with-a-function" class="level2">
<h2 class="anchored" data-anchor-id="summarizing-with-a-function"><strong>Summarizing with a Function</strong></h2>
<p>You will likely want to summarize the data in some way, for example, by obtaining the mean, sum, count, standard deviation, or some other statistic from the data. If we wanted to obtain the mean of some variable in the data frame, we would need to specify the variable that we want to summarize, the function for how to summarize that variable and then we would want to specify the variable name for the data frame to contain.</p>
<p>General case:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>summarized_var <span class="ot">=</span> <span class="fu">the_function</span>(my_var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Specific case:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mean <span class="ot">=</span> <span class="fu">mean</span>(my_var)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Let’s summarize the performance <code>Score</code> in the data frame. In the example below, we summarize data by creating a new variable which is set to represent some data summary technique. In essence, summarizing is for descriptive statistics. Using <code>mean()</code>, we can summarize the data by taking the mean of the <code>Score</code> variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">bob =</span> <span class="fu">mean</span>(Score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       bob
1 76.54545</code></pre>
</div>
</div>
<p>We see that the returned data frame contains only one row. By default, the data frame has been reduced to the mean across all rows. The column variable is named <code>bob</code>. Let’s make the variable in the returned data frame make more sense.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_score =</span> <span class="fu">mean</span>(Score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  mean_score
1   76.54545</code></pre>
</div>
</div>
<p>Notice what is returned is a single value reflecting the mean of all the data in the data frame. We could have obtained the same without using <strong>{dplyr}</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(DATA<span class="sc">$</span>Score)        <span class="co"># $ notation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76.54545</code></pre>
</div>
</div>
<p>However, we lose flexibility of easily adding new summary procedures using this approach. Instead, <code>summarize()</code> allows for multiple name-value pair functions.</p>
</section>
<section id="summarizing-with-multiple-functions" class="level2">
<h2 class="anchored" data-anchor-id="summarizing-with-multiple-functions"><strong>Summarizing with Multiple Functions</strong></h2>
<p>Let’s create the mean and the standard deviation of <code>Score</code> using <code>mean()</code>. Because you will use <code>mean()</code> often, you should understand how it works, so let’s first look at its parameters and default arguments more carefully.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x, <span class="at">trim =</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">FALSE</span>, ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>By default, the data are not trimmed and <code>NA</code> values are not removed. If <code>NA</code>s exist in your vector, the function will break unless you pass <code>TRUE</code> as the argument to it, <code>na.rm = TRUE</code>. The same is true for <code>sd()</code> for computing the standard deviation.</p>
<p>Let’s summarize <code>Score</code> using both functions. We see that the data frame has one row and two columns reflecting the variables specified in the function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Score, <span class="at">na.rm =</span> T),</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd   =</span> <span class="fu">sd</span>(Score, <span class="at">na.rm =</span> T)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      mean       sd
1 76.54545 10.56753</code></pre>
</div>
</div>
<p>You see the basic operation of <code>summarize()</code>. By default, variables are summarized using functions that aggregate the data across <strong>all</strong> rows. The resulting summary value is entered as column specified by the named we provided. Of course, however, we may not want to aggregate all of the data as a single group. Rather, we may wish to summarize by grouping data based on subgroups, factors, etc.</p>
</section>
</section>
<section id="aggregating-data" class="level1">
<h1><strong>Aggregating Data</strong></h1>
<p>Data aggregation refers to how data are organized or compiled. When you have multiple levels of data as presented in the example above, data aggregation refers to the process of taking the raw data and gathering it in some way to summarize for statistical analysis or data visualization. For example, you could summarize data by individual, class, school, district, county, and state. Alternatively, you could summarize data by district, county, and state and ignore individuals, class, and school. The two types of data aggregation will result in different numbers of cases (rows) in a data frame most obviously but also in the actual numbers.</p>
<p>The variability in individuals as well as in subgroups can be useful to answering your data question. Models like linear mixed models are beyond the scope of this course, however. Whether you look into those types of model or you don’t, you should realize that you are making a big assumption in your data when you aggregate at any level. That assumption is that the variability in the data that are aggregated is the same across all cases in the data. Specifically, by aggregating Tilford’s and Mildred’s individual data in order to obtain their average performance, you have lost the variability at the individual level and essentially arbitrarily set that variability to 0. At higher level, aggregating the data by <code>School</code> also means that you lose this information and make the assumption that there is no variability among individuals in each school (e.g., all individuals have the same value). Such assumptions are particularly relevant to repeated-measures models (e.g., repeated-measures ANOVA does not use this information) and are potentially not assumptions you want to make about your data.</p>
<p>In the end, how you interpret a model or a data visualization will be dependent on that aggregation of the data, modeled or displayed. The take home message about aggregating data, then, is that you trade off a loss of information for some summary. Only you can weigh the costs and benefits of this trade off. That said, sometimes you have no choice because your client, your employer, or your data resource has only data an an aggregate level. In those situations, you cannot do much except acknowledge the information loss in the ability of the model to predict an outcome. If, however, that aggregated level can still be summarized or aggregated in some way, you are back to reflecting on issues of aggregation.</p>
</section>
<section id="aggregating-data-using-group_by" class="level1">
<h1><strong>Aggregating Data using <code>group_by()</code></strong></h1>
<p><strong>{dplyr}</strong> has one main verb function for grouping data. <code>group_by()</code> orders the groups in an ascending order so that functions performed on the subgroups will return a data frame that is ordered based on the grouping variable(s). Other functions like <code>group_map()</code>, <code>group_nest()</code>, <code>group_split()</code>, and <code>group_trim()</code> exist but they are experimental for <strong>{dplyr}</strong> <code>r</code>packageVersion(“dplyr”)`. Although they allow for fun tasks like passing data subsets to statistical models, their experimental life cycle suggests you might not get to comfortable with them.</p>
<p><code>group_by()</code> is used to group data frames by one or more variables.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(.data, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>         ..., </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">.add =</span> <span class="cn">FALSE</span>, </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">.drop =</span> <span class="fu">group_by_drop_default</span>(.data)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>         )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Key Parameters/Arguments:</strong></p>
<ul>
<li><code>.data</code>: a data frame</li>
<li><code>...</code>: variables or computations to group by.</li>
</ul>
<p>The <code>.add</code> and <code>.drop</code> parameters are special cases of the function and will be addressed later. For now, let’s look at the basic functionality of <code>group_by()</code> used prior to <code>summarize().</code></p>
<section id="data-aggregation-using-group_by" class="level2">
<h2 class="anchored" data-anchor-id="data-aggregation-using-group_by"><strong>Data aggregation using <code>group_by()</code></strong></h2>
<p>Let’s say we want to group the data by <code>School</code> and then summarize. The returned data frame now contains two columns, one for the grouping variable followed by a second for the specification in <code>summarize()</code>. Importantly, the grouping variables will always be organized in the data frame to the left of variables created in the summary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School) <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Score =</span> <span class="fu">mean</span>(Score))   <span class="co"># get the school level aggregated data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  School Score
  &lt;chr&gt;  &lt;dbl&gt;
1 A       82.5
2 B       79.5
3 C       87  
4 D       62.5
5 E       66  </code></pre>
</div>
</div>
<p>Let’s say we try to determine <em>mean</em> performance for “all students” if we had the data aggregated as the <strong>school level</strong> and not the individual level. As a reminder, the mean across all rows in the data frame was <code>r</code>mean(DATA$Score, na.rm = T)`.</p>
<p>If we want to summarize the data frame that was summarized, we might assume that we can pipe the data to another add another <code>summarize()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School) <span class="sc">|&gt;</span>                <span class="co"># group by school</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Score =</span> <span class="fu">mean</span>(Score)) <span class="sc">|&gt;</span>  <span class="co"># get the school level aggregated data</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Score =</span> <span class="fu">mean</span>(Score))     <span class="co"># then calculate average across all schools</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  Score
  &lt;dbl&gt;
1  75.5</code></pre>
</div>
</div>
<p><strong>Note:</strong> If you noticed and wonder why the mean value returned here differs from <code>r</code>mean(DATA$Score, na.rm = T)`, make a mental note. We will address that later.</p>
<p>Let’s say we try to determine average performance for “all students” if we had the data aggregated as the <strong>district level</strong> and not the individual level.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(District) <span class="sc">|&gt;</span>                <span class="co"># group by district</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Score =</span> <span class="fu">mean</span>(Score)) <span class="sc">|&gt;</span>    <span class="co"># get the district level aggregated data</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Score =</span> <span class="fu">mean</span>(Score))       <span class="co"># then calculate average across all districts</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  Score
  &lt;dbl&gt;
1  77.4</code></pre>
</div>
</div>
<p>So what’s the average performance for students? Well, that interpretation differs based on how values are treated. At the highest level, all students’ <code>Scores</code> are weighed equally. Each student contributes to the data in the same way. When aggregated by <code>School</code>, each school contributes to the calculation equally, even if the number of bodies per school differs. And finally, when data are aggregated at the <code>District</code> level, all districts are treated equally in the calculation independent on the number of schools in a district. Only with weighting means would you end up with the same average performance.</p>
<p>Measures of variability in the data, however, reveal something else. Schools differ in variability and schools within districts vary as well. Depending on the level of aggregation, you may never notice interesting patterns in data that lead to questions to investigate and later policies to change. For example, addressing a school that is left behind others or a district that is left behind others. Aggregation can also lead to inefficient allocations of resources. If one school in a district needs help rather than all schools in the district needing help, the cost may differ substantially.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>std_error <span class="ot">&lt;-</span> <span class="cf">function</span>(x) { <span class="fu">sd</span>(<span class="fu">na.omit</span>(x)) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(<span class="fu">na.omit</span>(x))) }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Use <code>std_error()</code> in summary:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School, District) <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Var =</span> <span class="fu">var</span>(Score),</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD  =</span> <span class="fu">sd</span>(Score),</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">SEM =</span> <span class="fu">std_error</span>(Score),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">min =</span> <span class="fu">min</span>(Score),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(Score)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">range =</span> max <span class="sc">-</span> min)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'School'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 8
# Groups:   School [5]
  School District   Var    SD   SEM   min   max range
  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 A      West      12.5 3.54   2.5     80    85     5
2 B      West       0.5 0.707  0.5     79    80     1
3 C      East      28   5.29   3.06    81    91    10
4 D      North     12.5 3.54   2.5     60    65     5
5 E      North      2   1.41   1       65    67     2</code></pre>
</div>
</div>
</section>
</section>
<section id="comparing-mutate-with-summarize" class="level1">
<h1><strong>Comparing <code>mutate()</code> with <code>summarize()</code></strong></h1>
<p><strong>{dplyr}</strong> has two main verb functions for creating variables (e.g., <code>mutate()</code> and <code>summarize()</code>). They operate differently and their returned tibble also differ. If you have not been paying attention to the returned tibble post calculation, you might have overlooked the differences.</p>
<section id="grouping-structure-of-group_by-and-mutate" class="level2">
<h2 class="anchored" data-anchor-id="grouping-structure-of-group_by-and-mutate"><strong>Grouping structure of <code>group_by()</code> and <code>mutate()</code></strong></h2>
<p>Let’s <code>mutate()</code> the mean for <code>Score</code> after sub-setting with <code>group_by()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School, District) <span class="sc">|&gt;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Score =</span> <span class="fu">mean</span>(<span class="fu">na.omit</span>(Score)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 4
# Groups:   School, District [5]
   Student      Score School District
   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;   
 1 Jim           82.5 A      West    
 2 Sally         82.5 A      West    
 3 June          79.5 B      West    
 4 Mildred       79.5 B      West    
 5 Tilford       87   C      East    
 6 Beavis        87   C      East    
 7 Herman        87   C      East    
 8 Peppa         62.5 D      North   
 9 Kay           62.5 D      North   
10 Jake          66   E      North   
11 Name Missing  66   E      North   </code></pre>
</div>
</div>
<p>There are two things to watch when using this <code>mutate()</code> following <code>group_by()</code>.</p>
<ul>
<li><p><strong>1.</strong> A <code>Score</code> will be assigned to each row/case or <code>Student</code> in the data frame.</p>
<ul>
<li>When schools and districts are grouped, each student in the same school will have the same assigned average value. All rows are maintained, none dropped.</li>
</ul></li>
<li><p><strong>2.</strong> The returned tibble takes on a new structure.</p>
<ul>
<li>Looking at the feedback displayed in the console, you see the following report preceding the data.</li>
</ul></li>
</ul>
<pre><code>A tibble: 11 × 3
# Groups:   School, District [5]</code></pre>
<p>You also see this structure using <code>glimpse()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School, District) <span class="sc">|&gt;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Score =</span> <span class="fu">mean</span>(<span class="fu">na.omit</span>(Score))) <span class="sc">|&gt;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 11
Columns: 4
Groups: School, District [5]
$ Student  &lt;chr&gt; "Jim", "Sally", "June", "Mildred", "Tilford", "Beavis", "Herm…
$ Score    &lt;dbl&gt; 82.5, 82.5, 79.5, 79.5, 87.0, 87.0, 87.0, 62.5, 62.5, 66.0, 6…
$ School   &lt;chr&gt; "A", "A", "B", "B", "C", "C", "C", "D", "D", "E", "E"
$ District &lt;chr&gt; "West", "West", "West", "West", "East", "East", "East", "Nort…</code></pre>
</div>
</div>
<pre><code>Rows: 11
Columns: 3
Groups: School, District [5]</code></pre>
<p>What does the <code>[5]</code> mean? Well, before we answer this, let’s use <code>summarize()</code>.</p>
</section>
<section id="grouping-structure-of-group_by-and-summarize" class="level2">
<h2 class="anchored" data-anchor-id="grouping-structure-of-group_by-and-summarize"><strong>Grouping structure of <code>group_by()</code> and <code>summarize()</code></strong></h2>
<p>Let’s <code>summarize()</code> the mean for <code>Score</code> after sub-setting with <code>group_by()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School, District) <span class="sc">|&gt;</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Score =</span> <span class="fu">mean</span>(Score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'School'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
# Groups:   School [5]
  School District Score
  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
1 A      West      82.5
2 B      West      79.5
3 C      East      87  
4 D      North     62.5
5 E      North     66  </code></pre>
</div>
</div>
<p>There are two things to watch when using this <code>summarize()</code> following <code>group_by()</code>.</p>
<p><strong>1.</strong> A <code>Score</code> average is assigned to each row/case or <code>School</code> in this aggregated data frame.</p>
<p>When schools and districts are grouped, each school will have its own average value. Rows from the data frame are dropped as are columns that are not passed to <code>group_by()</code>. In this case, <code>School</code>, <code>District</code>, and the new variable, <code>Score</code> are returned.</p>
<p><strong>2.</strong> The returned tibble takes on a new structure.</p>
<p>The feedback in the console is a little more detailed here.</p>
<pre><code>`summarise()` has grouped output by 'School'. You can override using the `.groups` argument.
# A tibble: 5 × 3
# Groups:   School [5]</code></pre>
<p>You see reference to overriding the grouping using <code>.groups</code>. According to the <a href="https://dplyr.tidyverse.org/articles/grouping.html">tidyverse documentation for grouping</a>, this parameter <em>“controls the grouping structure of the output. The historical behaviour of removing the right hand side grouping variable corresponds to <code>.groups = "drop_last"</code> without a message or <code>.groups = NULL</code> with a message (the default)”</em>.</p>
<p>You have most likely paid little attention to this message. By default <code>summarize()</code> keeps the first grouping variable passed to <code>group_by()</code> in the returned tibble. This is why you see <code>School</code> referenced and not <code>District</code> or both variables. So, do you want your data frame to contain groups or no groups? Stated differently, do you just want that data summarized by your grouping variables and have a simple nxm data frame or do you want something more complex?</p>
<p>To see the structure better, let’s first look a the structure of <code>DATA</code> and then more closely at the summarized version.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(DATA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   11 obs. of  4 variables:
 $ Student : chr  "Jim" "Sally" "June" "Mildred" ...
 $ Score   : num  80 85 79 80 81 91 89 60 65 67 ...
 $ School  : chr  "A" "A" "B" "B" ...
 $ District: chr  "West" "West" "West" "West" ...</code></pre>
</div>
</div>
<p>Let’s assign the summarized data frame to an object for inspection.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>DATA_SUM <span class="ot">&lt;-</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  DATA <span class="sc">|&gt;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School, District) <span class="sc">|&gt;</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Score =</span> <span class="fu">mean</span>(Score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'School'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<p>For <code>DATA_SUM</code>, the structure is different. In particular, you see reference to <code>(S3: grouped_df/tbl_df/tbl/data.frame)</code>. This tells you that the data frame is not a simple nxm but contains groups. You could think of this as 3 nxm data frames organized together. For more details, see the <a href="https://dplyr.tidyverse.org/reference/grouped_df.html">dplyr</a> documentation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(DATA_SUM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>gropd_df [5 × 3] (S3: grouped_df/tbl_df/tbl/data.frame)
 $ School  : chr [1:5] "A" "B" "C" "D" ...
 $ District: chr [1:5] "West" "West" "East" "North" ...
 $ Score   : num [1:5] 82.5 79.5 87 62.5 66
 - attr(*, "groups")= tibble [5 × 2] (S3: tbl_df/tbl/data.frame)
  ..$ School: chr [1:5] "A" "B" "C" "D" ...
  ..$ .rows : list&lt;int&gt; [1:5] 
  .. ..$ : int 1
  .. ..$ : int 2
  .. ..$ : int 3
  .. ..$ : int 4
  .. ..$ : int 5
  .. ..@ ptype: int(0) 
  ..- attr(*, ".drop")= logi TRUE</code></pre>
</div>
</div>
<section id="group_by-and-summarize-with-.groups" class="level3">
<h3 class="anchored" data-anchor-id="group_by-and-summarize-with-.groups"><strong><code>group_by()</code> and <code>summarize()</code> with <code>.groups</code></strong></h3>
<p>When you group data using <code>group_by()</code> and then <code>summarize()</code>, the summary variables (e.g., mean) will result in a single row for each level of a single grouping variable. If there are more than one grouping variable, the additional grouping variable will be introduced to the data frame as a second column. The total number of rows in the data frame will be equal to the <em>number of levels of group 1</em> x <em>number of levels of group 2</em> if an only if each levels of group 1 has a corresponding level for group 2,</p>
<p>for example:</p>
<pre><code>sex   age    mean
men   young  x
men   old    x
women young  x
women old    x</code></pre>
<p>If there is no pairing of levels in the data (e.g., no men who are old), that row will be omitted from the returned data frame.</p>
<p>for example:</p>
<pre><code>sex   age    mean
men   young  x
women young  x
women old    x</code></pre>
<p>rather than:</p>
<pre><code>sex   age    mean
men   young  x
men   old    NA
women young  x
women old    x</code></pre>
<p>You really need to query <code>?dplyr::summarize</code> to understand <code>.groups</code>, which controls the grouping of the returned data frame. This is also experimental to <code>summarize()</code>, so it might not be available in the future.</p>
<p><strong>Parameters/Arguments:</strong></p>
<p>There are four argument options:</p>
<ul>
<li><code>"drop_last"</code>: dropping the last level of grouping. This was the only supported option before version 1.0.0.</li>
<li><code>"drop"</code>: All levels of grouping are dropped.</li>
<li><code>"keep"</code>: Same grouping structure as .data.</li>
<li><code>"rowwise"</code>: Each row is its own group.</li>
</ul>
<p>Let’s work through them individually and see how they work.</p>
<section id="groups-drop_last" class="level4">
<h4 class="anchored" data-anchor-id="groups-drop_last"><code>.groups = "drop_last"</code>:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School, District) <span class="sc">|&gt;</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Score =</span> <span class="fu">mean</span>(Score),</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop_last"</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
# Groups:   School [5]
  School District Score
  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
1 A      West      82.5
2 B      West      79.5
3 C      East      87  
4 D      North     62.5
5 E      North     66  </code></pre>
</div>
</div>
<p>You will see that the grouping for <code>District</code> is not in the grouping structure because it was the last grouping.</p>
<pre><code># A tibble: 5 × 3
# Groups:   School [5]
  School   District   Score</code></pre>
</section>
<section id="groups-drop" class="level4">
<h4 class="anchored" data-anchor-id="groups-drop"><code>.groups = "drop"</code>:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School, District) <span class="sc">|&gt;</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Score =</span> <span class="fu">mean</span>(Score),</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  School District Score
  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
1 A      West      82.5
2 B      West      79.5
3 C      East      87  
4 D      North     62.5
5 E      North     66  </code></pre>
</div>
</div>
<p>You will see that all <em>groups</em> are <em>dropped</em> from the grouping structure.</p>
<pre><code># A tibble: 5 × 3
  School District Score</code></pre>
</section>
<section id="groups-keep" class="level4">
<h4 class="anchored" data-anchor-id="groups-keep"><code>.groups = "keep"</code>:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School, District) <span class="sc">|&gt;</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Score =</span> <span class="fu">mean</span>(Score),</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"keep"</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
# Groups:   School, District [5]
  School District Score
  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
1 A      West      82.5
2 B      West      79.5
3 C      East      87  
4 D      North     62.5
5 E      North     66  </code></pre>
</div>
</div>
<p>You will see that all <em>groups</em> are <em>kept</em> in the grouping structure.</p>
<pre><code># A tibble: 5 × 3
# Groups:   School, District [5]
  School District Score</code></pre>
</section>
<section id="groups-rowwise" class="level4">
<h4 class="anchored" data-anchor-id="groups-rowwise"><code>.groups = "rowwise"</code>:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School, District) <span class="sc">|&gt;</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Score =</span> <span class="fu">mean</span>(Score),</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
# Rowwise:  School, District
  School District Score
  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
1 A      West      82.5
2 B      West      79.5
3 C      East      87  
4 D      North     62.5
5 E      North     66  </code></pre>
</div>
</div>
<p>You will see that there are groups but they are <em>not</em> based on <code>group_by()</code>.</p>
<pre><code># A tibble: 5 × 3
# Rowwise:  School, District
  School District Score</code></pre>
<p>The grouping structure always matters for subsequent computations. But with <code>"rowwise"</code> you will see this clearly. Following from above, let’s say we wanted to compute the mean across all of the <code>School</code>s in the data frame returned by <code>group_by()</code> then <code>summarize()</code>. We add <code>mutate(mean = mean(Score))</code> on a new line of our piped code block.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School, District) <span class="sc">|&gt;</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Score =</span> <span class="fu">mean</span>(Score),</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"rowwise"</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">|&gt;</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
# Rowwise:  School, District
  School District Score  mean
  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;
1 A      West      82.5  82.5
2 B      West      79.5  79.5
3 C      East      87    87  
4 D      North     62.5  62.5
5 E      North     66    66  </code></pre>
</div>
</div>
<p>The <code>mean</code> column does not contain a single mean replicated for each row in the data frame. Rather the grouping was per row, so each row has its one mean. The mean of a single value is, of course, itself.</p>
</section>
<section id="revisiting-.groups-drop_last" class="level4">
<h4 class="anchored" data-anchor-id="revisiting-.groups-drop_last">Revisiting <code>".groups = drop_last"</code>:</h4>
<p>Returning to the default <code>.groups</code> structure, which is <code>"drop_last"</code>, we can add the same <code>mutate()</code> to see what happens.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School, District) <span class="sc">|&gt;</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Score =</span> <span class="fu">mean</span>(Score),</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop_last"</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">|&gt;</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
# Groups:   School [5]
  School District Score  mean
  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;
1 A      West      82.5  82.5
2 B      West      79.5  79.5
3 C      East      87    87  
4 D      North     62.5  62.5
5 E      North     66    66  </code></pre>
</div>
</div>
<p>The <code>mean</code> column still has different values but they are replicated on rows with the same <code>School</code> group. This is because the data are grouped that way.</p>
</section>
<section id="revisiting-.groups-drop" class="level4">
<h4 class="anchored" data-anchor-id="revisiting-.groups-drop">Revisiting <code>.groups = "drop"</code>:</h4>
<p>Let’s again add the same <code>mutate()</code> to see what happens.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School, District) <span class="sc">|&gt;</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Score =</span> <span class="fu">mean</span>(Score),</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">|&gt;</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  School District Score  mean
  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;
1 A      West      82.5  75.5
2 B      West      79.5  75.5
3 C      East      87    75.5
4 D      North     62.5  75.5
5 E      North     66    75.5</code></pre>
</div>
</div>
</section>
<section id="consider-ungroup" class="level4">
<h4 class="anchored" data-anchor-id="consider-ungroup">Consider <code>ungroup()</code>:</h4>
<p><code>.groups = "drop"</code> in effect works the same as does <code>ungroup()</code>. The grouping structure is broken and all subsequent operations are based on the ungrouped data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School, District) <span class="sc">|&gt;</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Score =</span> <span class="fu">mean</span>(Score),</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop_last"</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">|&gt;</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  School District Score  mean
  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;
1 A      West      82.5  75.5
2 B      West      79.5  75.5
3 C      East      87    75.5
4 D      North     62.5  75.5
5 E      North     66    75.5</code></pre>
</div>
</div>
<p>Keep in mind that functions work as they are programmed to work. Functions do not work like you think they work. You must understand the function and check our work to ensure your calculations are what you intend them to be.</p>
</section>
<section id="the-order-of-operations-matters" class="level4">
<h4 class="anchored" data-anchor-id="the-order-of-operations-matters">The <em>order of operations</em> matters</h4>
<p>To illustrate further, consider you want to calculate some summary statistics. You set out to obtain the mean and the standard deviation for your data. Those computations will be performed according to the grouping structure.</p>
<p>When you compute standard deviation and the mean of <code>Score</code>, you assign the mean to <code>Score</code> because you want your plot to contain a clean name rather than one like <code>Score_Mean</code> that you will have to address in the plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School, District) <span class="sc">|&gt;</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Score_sd =</span> <span class="fu">sd</span>(Score),   <span class="co"># get sd </span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">Score =</span> <span class="fu">mean</span>(Score)     <span class="co"># get mean, assign to same name</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>            ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'School'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
# Groups:   School [5]
  School District Score_sd Score
  &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;
1 A      West        3.54   82.5
2 B      West        0.707  79.5
3 C      East        5.29   87  
4 D      North       3.54   62.5
5 E      North       1.41   66  </code></pre>
</div>
</div>
<p>Both variables use the same data because the standard deviation assigns the value to a different variable name <code>Score_sd</code>. The <code>mean()</code> is not based on some changed variable.</p>
<p>The output is different from the one returned when the mean is computed before the standard deviation and in particular when the mean is assigned to <code>Score</code>. In this case, the standard deviation is based on this new <code>Score</code> variable. Because the standard deviation is a measure of variability, and <code>Score</code> does not vary based on the grouping structure, <code>NA</code> is returned.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School, District) <span class="sc">|&gt;</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Score =</span> <span class="fu">mean</span>(Score),   <span class="co"># get mean, assign to same name</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">Score_sd =</span> <span class="fu">sd</span>(Score)   <span class="co"># get sd         </span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'School'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
# Groups:   School [5]
  School District Score Score_sd
  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 A      West      82.5       NA
2 B      West      79.5       NA
3 C      East      87         NA
4 D      North     62.5       NA
5 E      North     66         NA</code></pre>
</div>
</div>
<p>If you really wanted the standard deviation of all the means, consider ungrouping and then compute the standard deviation or use <code>.groups =  "drop"</code> in <code>summarize()</code>. Realize, however, this latter functionality is experimental and may not work sometime later. You are likely better off using <code>ungroup()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School, District) <span class="sc">|&gt;</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Score =</span> <span class="fu">mean</span>(Score)) <span class="sc">|&gt;</span>  <span class="co"># get mean, assign to same name</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sd =</span> <span class="fu">sd</span>(Score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'School'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  School District Score    sd
  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;
1 A      West      82.5  10.7
2 B      West      79.5  10.7
3 C      East      87    10.7
4 D      North     62.5  10.7
5 E      North     66    10.7</code></pre>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="more-on-grouping-structure" class="level1">
<h1><strong>More on Grouping Structure</strong></h1>
<p>We can now also consider ways to create column variables and a corresponding grouping structure within the <code>group_by()</code> verb.</p>
<section id="new-variable-columns" class="level2">
<h2 class="anchored" data-anchor-id="new-variable-columns"><strong>New Variable Columns</strong></h2>
<p><code>group_by()</code> is not designed to create new variables but rather create groups. The function, however, does not require variables in a data frame in order to group based on their levels or differences in values.</p>
<section id="group_by-using-a-function" class="level3">
<h3 class="anchored" data-anchor-id="group_by-using-a-function"><strong><code>group_by()</code> using a function</strong></h3>
<p>Heretofore, we have grouped by column variables in a data frame. But you can also group in other ways, for example, by a variable calculated by a function. For example, if you wanted to group by standard deviations, you could calculated the standard deviation <code>(Score-mean(Score)) / sd(Score)</code> for each student and then <code>cut()</code> that variable into groups. <code>cut</code> will take a numeric vector variable and turn it into a factor variable of <em>n</em> groups as determined by what you pass to <code>breaks</code>. There is also an argument to make the factor ordered if you wish, <code>ordered_result = TRUE</code> but the default behavior does not order the factor. You can also change the level labels if you inspect the function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">z_factor =</span> <span class="fu">cut</span>( </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> ((Score <span class="sc">-</span> <span class="fu">mean</span>(Score)) <span class="sc">/</span> <span class="fu">sd</span>(Score) ), </span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="dv">5</span>, </span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ordered_result =</span> T</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 5
# Groups:   z_factor [4]
   Student      Score School District z_factor       
   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    &lt;ord&gt;          
 1 Jim             80 A      West     (0.194,0.781]  
 2 Sally           85 A      West     (0.781,1.37]   
 3 June            79 B      West     (0.194,0.781]  
 4 Mildred         80 B      West     (0.194,0.781]  
 5 Tilford         81 C      East     (0.194,0.781]  
 6 Beavis          91 C      East     (0.781,1.37]   
 7 Herman          89 C      East     (0.781,1.37]   
 8 Peppa           60 D      North    (-1.57,-0.979] 
 9 Kay             65 D      North    (-1.57,-0.979] 
10 Jake            67 E      North    (-0.979,-0.392]
11 Name Missing    65 E      North    (-1.57,-0.979] </code></pre>
</div>
</div>
<p>You can see that there are 4 different levels of the grouping variable. The tibble is grouped of course too.</p>
<p>If you struggle with remembering the formula for a z score, <code>scale()</code> will to the same thing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z =</span> (Score <span class="sc">-</span> <span class="fu">mean</span>(Score))<span class="sc">/</span><span class="fu">sd</span>(Score),</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">scale =</span> <span class="fu">scale</span>(Score)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>         )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Student Score School District          z      scale
1           Jim    80      A     West  0.3269018  0.3269018
2         Sally    85      A     West  0.8000492  0.8000492
3          June    79      B     West  0.2322724  0.2322724
4       Mildred    80      B     West  0.3269018  0.3269018
5       Tilford    81      C     East  0.4215313  0.4215313
6        Beavis    91      C     East  1.3678261  1.3678261
7        Herman    89      C     East  1.1785671  1.1785671
8         Peppa    60      D    North -1.5656877 -1.5656877
9           Kay    65      D    North -1.0925403 -1.0925403
10         Jake    67      E    North -0.9032814 -0.9032814
11 Name Missing    65      E    North -1.0925403 -1.0925403</code></pre>
</div>
</div>
<p>If you want <em>n</em> groups based on specific breaks, then pass a vector of those break units. For example, if we want levels to correspond to some meaningful standard-deviation cuts. For example, if you wanted to group those with z scores ranging from infinitely negative to -2, -2 to -1, - to 1, 1 to 2, and 2 to infinitely large, you could specify the breaks. If there are no values in those ranges, then there won’t be any data for those breaks.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">z_factor =</span> <span class="fu">cut</span>( <span class="fu">scale</span>(Score), </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">Inf</span>),</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ordered_result =</span> T</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>                          ), </span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>           ) <span class="sc">|&gt;</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 5
   Student      Score School District z_factor
   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    &lt;ord&gt;   
 1 Jim             80 A      West     (-1,1]  
 2 Sally           85 A      West     (-1,1]  
 3 June            79 B      West     (-1,1]  
 4 Mildred         80 B      West     (-1,1]  
 5 Tilford         81 C      East     (-1,1]  
 6 Beavis          91 C      East     (1,2]   
 7 Herman          89 C      East     (1,2]   
 8 Peppa           60 D      North    (-2,-1] 
 9 Kay             65 D      North    (-2,-1] 
10 Jake            67 E      North    (-1,1]  
11 Name Missing    65 E      North    (-2,-1] </code></pre>
</div>
</div>
<p>You can also just group by the function without using <code>cut()</code> if you wish to group by those with identical values on the variable. In this case, using <code>count()</code> or <code>tally()</code> reveals there are only two instances with the same score.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">z_factor =</span> ((Score <span class="sc">-</span> <span class="fu">mean</span>(Score)) <span class="sc">/</span> <span class="fu">sd</span>(Score) )) <span class="sc">|&gt;</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(<span class="at">sort =</span> <span class="cn">TRUE</span>)     <span class="co"># tally(sort = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 2
# Groups:   z_factor [9]
  z_factor     n
     &lt;dbl&gt; &lt;int&gt;
1   -1.09      2
2    0.327     2
3   -1.57      1
4   -0.903     1
5    0.232     1
6    0.422     1
7    0.800     1
8    1.18      1
9    1.37      1</code></pre>
</div>
</div>
</section>
</section>
<section id="adddrop-grouping-variable-columns" class="level2">
<h2 class="anchored" data-anchor-id="adddrop-grouping-variable-columns"><strong>Add/drop Grouping Variable Columns</strong></h2>
<p>By default, <code>group_by()</code> on a data frame that is already grouped (see earlier on grouped data frame), the existing grouping structure will be replaced by new grouping structure.</p>
<p>Let’s get an example. Please note that this example assigned the tibble to an object but whether you assign or not, the grouped structure exists. So functions that follow the <code>group_by()</code> keep that structure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>(school_grouped <span class="ot">&lt;-</span> </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  DATA <span class="sc">|&gt;</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School) </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 4
# Groups:   School [5]
   Student      Score School District
   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;   
 1 Jim             80 A      West    
 2 Sally           85 A      West    
 3 June            79 B      West    
 4 Mildred         80 B      West    
 5 Tilford         81 C      East    
 6 Beavis          91 C      East    
 7 Herman          89 C      East    
 8 Peppa           60 D      North   
 9 Kay             65 D      North   
10 Jake            67 E      North   
11 Name Missing    65 E      North   </code></pre>
</div>
</div>
<p>Now group by a new column:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>school_grouped <span class="sc">|&gt;</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(District)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 4
# Groups:   District [3]
   Student      Score School District
   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;   
 1 Jim             80 A      West    
 2 Sally           85 A      West    
 3 June            79 B      West    
 4 Mildred         80 B      West    
 5 Tilford         81 C      East    
 6 Beavis          91 C      East    
 7 Herman          89 C      East    
 8 Peppa           60 D      North   
 9 Kay             65 D      North   
10 Jake            67 E      North   
11 Name Missing    65 E      North   </code></pre>
</div>
</div>
<p>You will see the grouping structure has changed.</p>
<pre><code># A tibble: 11 × 4
# Groups:   District [3]</code></pre>
<section id="retain-grouping" class="level3">
<h3 class="anchored" data-anchor-id="retain-grouping"><strong>Retain Grouping</strong></h3>
<p>If you want to retain the existing group, you would need to use <code>.add = TRUE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>school_grouped <span class="sc">|&gt;</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(District, <span class="at">.add =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 4
# Groups:   School, District [5]
   Student      Score School District
   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;   
 1 Jim             80 A      West    
 2 Sally           85 A      West    
 3 June            79 B      West    
 4 Mildred         80 B      West    
 5 Tilford         81 C      East    
 6 Beavis          91 C      East    
 7 Herman          89 C      East    
 8 Peppa           60 D      North   
 9 Kay             65 D      North   
10 Jake            67 E      North   
11 Name Missing    65 E      North   </code></pre>
</div>
</div>
<p>Notice in the console, that both <code>School</code> and <code>District</code> are included in the groups.</p>
<pre><code># A tibble: 11 × 4
# Groups:   School, District [5]</code></pre>
</section>
</section>
<section id="why-care-about-grouping-structure" class="level2">
<h2 class="anchored" data-anchor-id="why-care-about-grouping-structure"><strong>Why Care About Grouping Structure</strong></h2>
<p>Well, the functions you apply to a grouped tibble will sometimes lead to calculations that are not what you intend. We provided some examples earlier but given the importance of the issue, we may benefit from another example.</p>
<p>Let’s say you want to compute the average for each school and add that school average for each student. This would tell you how the student differs from their school performance. Then you want to obtain the mean of all the schools and see how the school differs from all the schools.</p>
<p>You code it out:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group </span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School) <span class="sc">|&gt;</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the mean of Score for each School</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">School_Mean =</span> <span class="fu">mean</span>(Score)) <span class="sc">|&gt;</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the mean of all values (think Grand Mean from stats)</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Mean_of_all =</span> <span class="fu">mean</span>(School_Mean)) <span class="sc">|&gt;</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the school performance relative to all</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">School_Performance =</span> <span class="fu">factor</span>(</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">case_when</span>(</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>      School_Mean <span class="sc">&lt;</span> Mean_of_all <span class="sc">~</span> <span class="st">"Below Average"</span>,</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>      School_Mean <span class="sc">==</span> Mean_of_all <span class="sc">~</span> <span class="st">"Average"</span>,</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>      School_Mean <span class="sc">&gt;</span> Mean_of_all <span class="sc">~</span> <span class="st">"Above Average"</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>      ), <span class="at">ordered =</span> T)</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 7
# Groups:   School [5]
   Student      Score School District School_Mean Mean_of_all School_Performance
   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;       &lt;dbl&gt; &lt;ord&gt;             
 1 Jim             80 A      West            82.5        82.5 Average           
 2 Sally           85 A      West            82.5        82.5 Average           
 3 June            79 B      West            79.5        79.5 Average           
 4 Mildred         80 B      West            79.5        79.5 Average           
 5 Tilford         81 C      East            87          87   Average           
 6 Beavis          91 C      East            87          87   Average           
 7 Herman          89 C      East            87          87   Average           
 8 Peppa           60 D      North           62.5        62.5 Average           
 9 Kay             65 D      North           62.5        62.5 Average           
10 Jake            67 E      North           66          66   Average           
11 Name Missing    65 E      North           66          66   Average           </code></pre>
</div>
</div>
<p>Perfect. OK, let’s plot it. Oh but first let me inspect the data. Um, why is <code>School_Performance</code> the same for all <code>Students</code>? Schools are not performing the same so they cannot all be average. Check your <code>case_when()</code> for errors because that where the new variable was created. Then you spend 40 days and 40 nights trying to fix your code. No matter what you do with <code>case_when()</code>, you cannot fix the problem. So you try to create 42 data frames to solve your problem. Even grandma knows that is a ridiculous strategy. She suggests you read the documentation for all of the functions you used because one time her pot-luck cake flopped and she inspected the expiration date for all of her ingredients and found the baking soda was old.</p>
<p>You discover that the grouping structure is retained on all operations until that grouping structure is removed or replaced.</p>
</section>
</section>
<section id="ungroup" class="level1">
<h1><strong>ungroup()</strong></h1>
<p>Whereas summarize has a <code>.groups</code> functionality, <code>mutate()</code> does not. In order to have a simple data frame use follow <code>group_by()</code> and <code>mutate()</code> with <code>ungroup()</code>. But <code>ungroup()</code> can be used following both functions if that approach makes more sense to you.</p>
<p>Let’s add an <code>ungroup()</code> directly after performing the operation that needed the grouping structure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group </span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School) <span class="sc">|&gt;</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the mean of Score for each School</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">School_Mean =</span> <span class="fu">mean</span>(Score)) <span class="sc">|&gt;</span>  </span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># break that grouping structure</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the mean of all values (think Grand Mean from stats)</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Mean_of_all =</span> <span class="fu">mean</span>(School_Mean)) <span class="sc">|&gt;</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the school performance relative to all</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">School_Performance =</span> <span class="fu">factor</span>(</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">case_when</span>(</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>      School_Mean <span class="sc">&lt;</span> Mean_of_all <span class="sc">~</span> <span class="st">"Below Average"</span>,</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>      School_Mean <span class="sc">==</span> Mean_of_all <span class="sc">~</span> <span class="st">"Average"</span>,</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>      School_Mean <span class="sc">&gt;</span> Mean_of_all <span class="sc">~</span> <span class="st">"Above Average"</span></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>      ), <span class="at">ordered =</span> T)</span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 7
   Student      Score School District School_Mean Mean_of_all School_Performance
   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;       &lt;dbl&gt; &lt;ord&gt;             
 1 Jim             80 A      West            82.5        76.5 Above Average     
 2 Sally           85 A      West            82.5        76.5 Above Average     
 3 June            79 B      West            79.5        76.5 Above Average     
 4 Mildred         80 B      West            79.5        76.5 Above Average     
 5 Tilford         81 C      East            87          76.5 Above Average     
 6 Beavis          91 C      East            87          76.5 Above Average     
 7 Herman          89 C      East            87          76.5 Above Average     
 8 Peppa           60 D      North           62.5        76.5 Below Average     
 9 Kay             65 D      North           62.5        76.5 Below Average     
10 Jake            67 E      North           66          76.5 Below Average     
11 Name Missing    65 E      North           66          76.5 Below Average     </code></pre>
</div>
</div>
<p>Yes! <code>Mean_of_all</code> is now a true grand mean based on all of the data with no grouping at all. Comparing <code>Mean_of_all</code> to <code>School_Mean</code> provides two classifications.</p>
<section id="variable-loss-with-summarize" class="level2">
<h2 class="anchored" data-anchor-id="variable-loss-with-summarize"><strong>Variable loss with <code>summarize()</code></strong></h2>
<p>Because <code>summarize()</code> returns a tibble based on the grouping structure, you will lose all variables that are not in the grouping structure. By design, it no longer allows you to return a data frame with duplicated rows based on the variables passed to <code>group_by()</code>.</p>
<p>Returning to the school data, what this means, is that you cannot retain the <code>School</code> if you group by the <code>District</code> in order to obtain averages by district.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(District) <span class="sc">|&gt;</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(Score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  District  Mean
  &lt;chr&gt;    &lt;dbl&gt;
1 East      87  
2 North     64.2
3 West      81  </code></pre>
</div>
</div>
<p>If you try to add <code>School</code> to <code>group_by()</code>, then you will only obtain the averages by schools within districts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School, District) <span class="sc">|&gt;</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(Score)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'School'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
# Groups:   School [5]
  School District  Mean
  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
1 A      West      82.5
2 B      West      79.5
3 C      East      87  
4 D      North     62.5
5 E      North     66  </code></pre>
</div>
</div>
<p>You can try to summarize based on a variable without assign it to a function but that is no longer allowed with <code>summarize()</code>. The following code block will throw an error.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(District) <span class="sc">|&gt;</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(Score),</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>          School               <span class="co"># add school </span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="an-alternative-to-summarize-reframe" class="level2">
<h2 class="anchored" data-anchor-id="an-alternative-to-summarize-reframe"><strong>An alternative to <code>summarize()</code>: <code>reframe()</code></strong></h2>
<p>Instead, you can use <code>reframe()</code>, which allows for previous functionality of <code>summarize()</code> that is now deprecated.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(District) <span class="sc">|&gt;</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(Score),</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>          School,</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>          Student</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 4
   District  Mean School Student     
   &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;       
 1 East      87   C      Tilford     
 2 East      87   C      Beavis      
 3 East      87   C      Herman      
 4 North     64.2 D      Peppa       
 5 North     64.2 D      Kay         
 6 North     64.2 E      Jake        
 7 North     64.2 E      Name Missing
 8 West      81   A      Jim         
 9 West      81   A      Sally       
10 West      81   B      June        
11 West      81   B      Mildred     </code></pre>
</div>
</div>
<p>Remember that the operations in <code>summarize()</code>, <code>mutate()</code>, and <code>reframe()</code> all depend on the grouping structure. If you wanted to add variables, you would need to group a different way and you would need to add all variables into <code>summarize()</code> every step of the way.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(District) <span class="sc">|&gt;</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">District_Mean =</span> <span class="fu">mean</span>(Score),</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>          School, </span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>          Student,</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>          Score</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">|&gt;</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School) <span class="sc">%&gt;%</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">School_Mean =</span> <span class="fu">mean</span>(Score),</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>          School, </span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>          Student,</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>          Score,</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>          District_Mean</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">|&gt;</span></span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 5
   School School_Mean Student      Score District_Mean
   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;         &lt;dbl&gt;
 1 A             82.5 Jim             80          81  
 2 A             82.5 Sally           85          81  
 3 B             79.5 June            79          81  
 4 B             79.5 Mildred         80          81  
 5 C             87   Tilford         81          87  
 6 C             87   Beavis          91          87  
 7 C             87   Herman          89          87  
 8 D             62.5 Peppa           60          64.2
 9 D             62.5 Kay             65          64.2
10 E             66   Jake            67          64.2
11 E             66   Name Missing    65          64.2</code></pre>
</div>
</div>
</section>
<section id="retaining-distinct-data-after-mutate-using-distinct" class="level2">
<h2 class="anchored" data-anchor-id="retaining-distinct-data-after-mutate-using-distinct"><strong>Retaining distinct data after <code>mutate()</code> using <code>distinct()</code></strong></h2>
<p>This is just too tedious. Your better option is <code>mutate()</code> as all variables will be added to the full data frame. All variables are neatly and logically appended to the right hand side of the data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(District) <span class="sc">|&gt;</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">District_Mean =</span> <span class="fu">mean</span>(Score)) <span class="sc">|&gt;</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School) <span class="sc">|&gt;</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">School_Mean =</span> <span class="fu">mean</span>(Score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 6
# Groups:   School [5]
   Student      Score School District District_Mean School_Mean
   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;            &lt;dbl&gt;       &lt;dbl&gt;
 1 Jim             80 A      West              81          82.5
 2 Sally           85 A      West              81          82.5
 3 June            79 B      West              81          79.5
 4 Mildred         80 B      West              81          79.5
 5 Tilford         81 C      East              87          87  
 6 Beavis          91 C      East              87          87  
 7 Herman          89 C      East              87          87  
 8 Peppa           60 D      North             64.2        62.5
 9 Kay             65 D      North             64.2        62.5
10 Jake            67 E      North             64.2        66  
11 Name Missing    65 E      North             64.2        66  </code></pre>
</div>
</div>
<p>Also, when you use a new <code>group_by()</code>, it will replace previous grouping structure by default. The following two code blocks return the same data frame.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(District) <span class="sc">|&gt;</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">District_Mean =</span> <span class="fu">mean</span>(Score)) <span class="sc">|&gt;</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School) <span class="sc">|&gt;</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">School_Mean =</span> <span class="fu">mean</span>(Score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>With <code>ungroup()</code>:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(District) <span class="sc">|&gt;</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">District_Mean =</span> <span class="fu">mean</span>(Score)) <span class="sc">|&gt;</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span>                            <span class="co"># ungroup</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School) <span class="sc">|&gt;</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">School_Mean =</span> <span class="fu">mean</span>(Score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you wish those variables to remain, you have a couple of options. The first would be to use <code>mutate()</code>.</p>
<p>Notice, however, that if you want to extract the summaries from the large data frame as you would have had you used <code>summarize()</code>, you cannot just <code>select()</code> your column of interest because the repetitions will exist for each row in the data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(District) <span class="sc">|&gt;</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">District_Mean =</span> <span class="fu">mean</span>(Score)) <span class="sc">|&gt;</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"School"</span>, <span class="st">"District_Mean"</span>))    <span class="co"># if passing a vector, use any_of() or all_of())</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Adding missing grouping variables: `District`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 3
# Groups:   District [3]
   District School District_Mean
   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
 1 West     A               81  
 2 West     A               81  
 3 West     B               81  
 4 West     B               81  
 5 East     C               87  
 6 East     C               87  
 7 East     C               87  
 8 North    D               64.2
 9 North    D               64.2
10 North    E               64.2
11 North    E               64.2</code></pre>
</div>
</div>
<p>You can obtain the rows that are <code>distinct()</code> (unique) and then <code>pick()</code> the ones to keep.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(District) <span class="sc">|&gt;</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">District_Mean =</span> <span class="fu">mean</span>(Score)) <span class="sc">|&gt;</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(<span class="fu">pick</span>(<span class="fu">c</span>(<span class="st">"District"</span>, <span class="st">"District_Mean"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
# Groups:   District [3]
  District District_Mean
  &lt;chr&gt;            &lt;dbl&gt;
1 West              81  
2 East              87  
3 North             64.2</code></pre>
</div>
</div>
<p>But you will need to <code>ungroup()</code> before <code>distinct()</code> because, as we have mentioned before, all subsequent functions other than <code>group_by()</code> will maintain the previous grouping structure by default.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>DATA <span class="sc">|&gt;</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(School) <span class="sc">|&gt;</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">School_Mean =</span> <span class="fu">mean</span>(Score)) <span class="sc">|&gt;</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 5
   Student      Score School District School_Mean
   &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;
 1 Jim             80 A      West            82.5
 2 Sally           85 A      West            82.5
 3 June            79 B      West            79.5
 4 Mildred         80 B      West            79.5
 5 Tilford         81 C      East            87  
 6 Beavis          91 C      East            87  
 7 Herman          89 C      East            87  
 8 Peppa           60 D      North           62.5
 9 Kay             65 D      North           62.5
10 Jake            67 E      North           66  
11 Name Missing    65 E      North           66  </code></pre>
</div>
</div>
</section>
</section>
<section id="summary" class="level1">
<h1><strong>Summary</strong></h1>
<p>How data are aggregated will affect both summary statistics, the models that you can run, and the data visualizations that you can create to represent the data. With each level of aggregation, fine-grained or case-level data are lost. That fine-grained detail may be computed with measures like variability and confidence levels but those measures are summaries themselves. Including them is not the same as including all data. That said, including all data may influence model outcome and statistical inference. The data will also influence the interpretation of plots to the extent that outlying points or grouping characteristics (point proximity) drive attention to physical locations of plots at the cost of attending to other locations.</p>
<p>A main workhorse of adding variables and creating aggregated data in the <code>R</code> language is the <strong>{dplyr}</strong> library. You must, however, be sensitive to the way its functions work so that the variables you create in either a full or summarized data frame represent your intentions and goals.</p>
<p>We have seen that a lot of customization can be applied to our visualizations of data and have shown just a little bit of what can be done. Many more functions and parameters can be used to customize to greater extents.</p>
</section>
<section id="advanced-summarizing-techniques" class="level1">
<h1><strong>Advanced Summarizing Techniques</strong></h1>
<p>For more <em>advanced</em> summarizing techniques, see this module on <a href="https://gabrielcook.xyz/fods24/modules/">advanced summarizing techniques</a>.</p>
</section>
<section id="session-info" class="level1">
<h1><strong>Session Info</strong></h1>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.2 (2023-10-31 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 11 x64 (build 22621)

Matrix products: default


locale:
[1] LC_COLLATE=English_United States.utf8 
[2] LC_CTYPE=English_United States.utf8   
[3] LC_MONETARY=English_United States.utf8
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.utf8    

time zone: America/Los_Angeles
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices datasets  utils     methods   base     

other attached packages:
[1] dplyr_1.1.4

loaded via a namespace (and not attached):
 [1] bit_4.0.5           jsonlite_1.8.7      crayon_1.5.2       
 [4] compiler_4.3.2      BiocManager_1.30.22 renv_1.0.3         
 [7] tidyselect_1.2.0    stringr_1.5.1       parallel_4.3.2     
[10] yaml_2.3.7          fastmap_1.1.1       here_1.0.1         
[13] readr_2.1.4         R6_2.5.1            generics_0.1.3     
[16] curl_5.2.0          knitr_1.45          htmlwidgets_1.6.4  
[19] tibble_3.2.1        rprojroot_2.0.3     pillar_1.9.0       
[22] tzdb_0.4.0          R.utils_2.12.2      rlang_1.1.1        
[25] utf8_1.2.4          stringi_1.7.12      xfun_0.40          
[28] bit64_4.0.5         cli_3.6.1           withr_2.5.0        
[31] magrittr_2.0.3      digest_0.6.33       vroom_1.6.5        
[34] rstudioapi_0.15.0   hms_1.1.3           lifecycle_1.0.3    
[37] R.methodsS3_1.8.2   R.oo_1.25.0         vctrs_0.6.5        
[40] evaluate_0.21       glue_1.6.2          fansi_1.0.4        
[43] rmarkdown_2.25      tools_4.3.2         pkgconfig_2.0.3    
[46] htmltools_0.5.7    </code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>