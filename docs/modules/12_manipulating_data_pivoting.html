<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gabriel I. Cook">

<title>PSYC166 - Transforming Data Frames: Pivoting</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://kit.fontawesome.com/78ddb093ea.js" crossorigin="anonymous"></script>


<link rel="stylesheet" href="../css/nav.css">
<link rel="stylesheet" href="../css/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title"><strong>PSYC166</strong></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text"><strong>Home</strong></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../syllabus/syllabus.html" rel="" target="" aria-current="page">
 <span class="menu-text"><strong>Syllabus</strong></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../modules/index.html" rel="" target="">
 <span class="menu-text"><strong>Modules</strong></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../project/index.html" rel="" target="">
 <span class="menu-text"><strong>Project</strong></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-slides" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text"><strong>Slides</strong></span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-slides">    
        <li>
    <a class="dropdown-item" href="../slides/01_intro_rstudio_rmarkdown_slides.html" rel="" target="">
 <span class="dropdown-text">R, RStudio, &amp; R Markdown</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/02_git_slides.html" rel="" target="">
 <span class="dropdown-text">Git and GitHub</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/03_functions_slides.html" rel="" target="">
 <span class="dropdown-text">Functions, Parameters, and Arguments</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/04_vectors_and_data_frames_slides.html" rel="" target="">
 <span class="dropdown-text">Vectors and Data Frames</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/05_importing_and_exporting_slides.html" rel="" target="">
 <span class="dropdown-text">Importing and Exporting Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/06_variables_cognition_slides.html" rel="" target="">
 <span class="dropdown-text">Variables, Measures of Cognition</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/07_manipulating_data_selecting_filtering_mutating_slides.html" rel="" target="">
 <span class="dropdown-text">Manipulating Data: Selecting, Filtering, &amp; Mutating</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/08_cognitive_data_slides.html" rel="" target="">
 <span class="dropdown-text">Cognitive Task Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/09_summarizing_data_slides.html" rel="" target="">
 <span class="dropdown-text">Grouping and Summarizing Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/09_summarizing_data_advanced_slides.html" rel="" target="">
 <span class="dropdown-text">Grouping and Summarizing Data (Advanced)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/10_cognitive_data_summary_slides.html" rel="" target="">
 <span class="dropdown-text">Summarizing Task Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/07_manipulating_data_pivoting_slides.html" rel="" target="">
 <span class="dropdown-text">Transforming Data: Pivoting</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/13_joining_data_slides.html" rel="" target="">
 <span class="dropdown-text">Joining Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/11_visualizing_data_slides.html" rel="" target="">
 <span class="dropdown-text">Visualizing Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/12_examining_relationships_slides.html" rel="" target="">
 <span class="dropdown-text">Examining Relationships</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/14_strings_and_factors_slides.html" rel="" target="">
 <span class="dropdown-text">Strings, Factors, and Regular Expressions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/16_models_project_slides.html" rel="" target="">
 <span class="dropdown-text">Discussing Models for Cognitive Tasks</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/17_linear_models_slides.html" rel="" target="">
 <span class="dropdown-text">Linear Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../slides/18_eda_slides.html" rel="" target="">
 <span class="dropdown-text">Exploratory Data Analysis</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hw" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text"><strong>HW</strong></span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hw">    
        <li>
    <a class="dropdown-item" href="https://raw.githubusercontent.com/slicesofdata/fods24/main/homework/HW01.Rmd" rel="" target="">
 <span class="dropdown-text">HW 01</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://raw.githubusercontent.com/slicesofdata/fods24/main/homework/HW02.Rmd" rel="" target="">
 <span class="dropdown-text">HW 02</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://raw.githubusercontent.com/slicesofdata/fods24/main/homework/HW03.Rmd" rel="" target="">
 <span class="dropdown-text">HW 03</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://raw.githubusercontent.com/slicesofdata/fods24/main/homework/HW04.Rmd" rel="" target="">
 <span class="dropdown-text">HW 04</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://raw.githubusercontent.com/slicesofdata/fods24/main/homework/HW05.Rmd" rel="" target="">
 <span class="dropdown-text">HW 05</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://raw.githubusercontent.com/slicesofdata/fods24/main/homework/HW06.Rmd" rel="" target="">
 <span class="dropdown-text">HW 06</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://raw.githubusercontent.com/slicesofdata/fods24/main/homework/HW07.Rmd" rel="" target="">
 <span class="dropdown-text">HW 07</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://raw.githubusercontent.com/slicesofdata/fods24/main/homework/HW08.Rmd" rel="" target="">
 <span class="dropdown-text">HW 08</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://raw.githubusercontent.com/slicesofdata/fods24/main/homework/HW09.Rmd" rel="" target="">
 <span class="dropdown-text">HW 09</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://raw.githubusercontent.com/slicesofdata/fods24/main/homework/HW10.Rmd" rel="" target="">
 <span class="dropdown-text">HW 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text"><strong>Exercises</strong></span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-exercises">    
        <li>
    <a class="dropdown-item" href="../exercises/using_git_with_projects_exercise.Rmd" rel="" target="">
 <span class="dropdown-text">using_git_with_projects_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/functions_exercise.docx" rel="" target="">
 <span class="dropdown-text">functions_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/vectors_and_dataframes_exercise.docx" rel="" target="">
 <span class="dropdown-text">vectors_and_dataframes_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/imorting_and_exporting_exercise.docx" rel="" target="">
 <span class="dropdown-text">importing_and_exporting_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/transforming_exercise.docx" rel="" target="">
 <span class="dropdown-text">transforming_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/summarizing_exercise.docx" rel="" target="">
 <span class="dropdown-text">summarizing_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/visualizing_exercise.docx" rel="" target="">
 <span class="dropdown-text">visualizing_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/pivoting_exercise.docx" rel="" target="">
 <span class="dropdown-text">pivoting_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/strings_and_factors_exercise.docx" rel="" target="">
 <span class="dropdown-text">strings_and_factors_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/joining_exercise.docx" rel="" target="">
 <span class="dropdown-text">joining_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/linear_models_exercise.Rmd" rel="" target="">
 <span class="dropdown-text">linear_models_exercise.docx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises/eda_exercise.docx" rel="" target="">
 <span class="dropdown-text">eda_exercise.docx</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-data" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text"><strong>Data</strong></span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-data">    
        <li>
    <a class="dropdown-item" href="https://github.com/slicesofdata/dataviz23/raw/main/data/cms-top-all-time-2023-swim.zip" rel="" target="">
 <span class="dropdown-text">cms-top-all-time-2023-swim.xlsx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/rfordatascience/tidytuesday" rel="" target="">
 <span class="dropdown-text">Fun Tidy Tuesday Data Sets</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://dcas.dmdc.osd.mil/dcas/app/home" rel="" target="">
 <span class="dropdown-text">Defense Casualty Analysis System (DCAS)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-cheatsheets" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text"><strong>Cheatsheets</strong></span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-cheatsheets">    
        <li>
    <a class="dropdown-item" href="../cheatsheets_and_tips/symbols.html" rel="" target="">
 <span class="dropdown-text">Symbols</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../cheatsheets/rmarkdown-2.0.pdf" rel="" target="">
 <span class="dropdown-text">RMarkdown</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf" rel="" target="">
 <span class="dropdown-text">Data Wrangling with {dplyr} and {tidyr}</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://rstudio.github.io/cheatsheets/html/quarto.html" rel="" target="">
 <span class="dropdown-text">Quarto (Publish and Share)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://rstudio.github.io/cheatsheets/html/strings.html" rel="" target="">
 <span class="dropdown-text">String Manipulation with {stringr}</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://rstudio.github.io/cheatsheets/html/data-import.html" rel="" target="">
 <span class="dropdown-text">Reading and Writing Data with {readr}</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../cheatsheets/Data_Science_With_R_Workflow.pdf" rel="" target="">
 <span class="dropdown-text">Data Science with RWorkflow</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://rstudio.github.io/cheatsheets/" rel="" target="">
 <span class="dropdown-text">More Cheatsheets From RStudio</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://images.datacamp.com/image/upload/v1676540721/Marketing/Blog/Quarto_Cheat_Sheet.pdf" rel="" target="">
 <span class="dropdown-text">Quarto Cheat Sheet (what Quarto Files Look Like)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../resources/tools.html" rel="" target="">
 <span class="menu-text"><strong>Other Tools</strong></span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/slicesofdata" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://gabrielcook.xyz" rel="" target="">
 <span class="menu-text">Me</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../modules/index.html">Modules</a></li><li class="breadcrumb-item"><a href="../modules/12_manipulating_data_pivoting.html"><strong>Transforming Data Frames: Pivoting</strong></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Syllabus</strong></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../modules/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modules</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/01_installing_r_and_rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Installing R &amp; RStudio</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/01_introduction_to_r_rstudio_and_rmarkdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Introduction to RStudio and R Markdown</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/02_installing_and_setting_up_git_and_github.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Project Management 01: Installing and Setting Up Git and GitHub for R</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/02_using_git_and_github.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Project Management 02: R Projects, Git, and GitHub</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/04_functions_and_scripts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Functions, Arguments, and R scripts</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/05_vectors_and_data_frame_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Vectors and Data Frame Basics</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/06_importing_and_exporting_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Importing and Exporting Data Frames</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/07_variables_and_measures_of_cognition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Variables and Measures of Cognition</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/08_manipulating_data_selecting_filtering_mutating.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Selecting, Filtering, &amp; Mutating</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/09_working_with_cognitive_task_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Working with Cognitive Task Data</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/10_summarizing_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Summarizing Data</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/11_summarizing_cognitive_task_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Summarizing Cognitive Task Data</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/12_manipulating_data_pivoting.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><strong>Transforming Data Frames: Pivoting</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/13_visualizing_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Visualizing Data: {ggplot} and the grammar of graphics</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/14_joining_relational_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Joining Relational Data</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/15_joining_project_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Joining Project Data</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/16_examining_relationships_in_variables_of_cognition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Examining Relationships in Variables of Cognition</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/17_strings_and_factors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Strings, Factors, and Regular Expressions</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/18_linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Linear Models</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/19_exploratory_data_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Exploratory Data Analysis</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/summarizing_data_advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Summarizing Data: Using <code>across()</code> and Lists</strong></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../project/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project/01_project_team_roles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Team membership and roles</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project/02_project_midterm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Midterm presentation</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project/03_project_final.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Final Presentation</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project/04_project_report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Final Report</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project/05_project_tasks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Project Tasks</strong></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><strong>Overview</strong></a>
  <ul class="collapse">
  <li><a href="#readings-and-preparation" id="toc-readings-and-preparation" class="nav-link" data-scroll-target="#readings-and-preparation"><strong>Readings and Preparation</strong></a></li>
  <li><a href="#supplementary-readings-optional" id="toc-supplementary-readings-optional" class="nav-link" data-scroll-target="#supplementary-readings-optional"><strong>Supplementary Readings (Optional)</strong></a></li>
  </ul></li>
  <li><a href="#libraries" id="toc-libraries" class="nav-link" data-scroll-target="#libraries"><strong>Libraries</strong></a>
  <ul class="collapse">
  <li><a href="#loading-libraries" id="toc-loading-libraries" class="nav-link" data-scroll-target="#loading-libraries"><strong>Loading Libraries</strong></a></li>
  </ul></li>
  <li><a href="#data-structure-formats" id="toc-data-structure-formats" class="nav-link" data-scroll-target="#data-structure-formats"><strong>Data Structure Formats</strong></a>
  <ul class="collapse">
  <li><a href="#wide-format-data" id="toc-wide-format-data" class="nav-link" data-scroll-target="#wide-format-data"><strong>Wide Format Data</strong></a></li>
  <li><a href="#long-format-data" id="toc-long-format-data" class="nav-link" data-scroll-target="#long-format-data"><strong>Long Format Data</strong></a></li>
  <li><a href="#tidy-data" id="toc-tidy-data" class="nav-link" data-scroll-target="#tidy-data"><strong>Tidy Data</strong></a></li>
  </ul></li>
  <li><a href="#creating-sample-data" id="toc-creating-sample-data" class="nav-link" data-scroll-target="#creating-sample-data"><strong>Creating Sample Data</strong></a>
  <ul class="collapse">
  <li><a href="#inspectingtaking-inventory-of-the-data-structure" id="toc-inspectingtaking-inventory-of-the-data-structure" class="nav-link" data-scroll-target="#inspectingtaking-inventory-of-the-data-structure"><strong>Inspecting/Taking Inventory of the Data Structure</strong></a></li>
  <li><a href="#inspectingtaking-inventory-of-the-data-structure-1" id="toc-inspectingtaking-inventory-of-the-data-structure-1" class="nav-link" data-scroll-target="#inspectingtaking-inventory-of-the-data-structure-1"><strong>Inspecting/Taking Inventory of the Data Structure</strong></a></li>
  </ul></li>
  <li><a href="#pivoting-from-wide-to-long" id="toc-pivoting-from-wide-to-long" class="nav-link" data-scroll-target="#pivoting-from-wide-to-long"><strong>Pivoting from Wide to Long</strong></a>
  <ul class="collapse">
  <li><a href="#pivoting-using-tidyrpivot_longer" id="toc-pivoting-using-tidyrpivot_longer" class="nav-link" data-scroll-target="#pivoting-using-tidyrpivot_longer"><strong>Pivoting using <code>tidyr::pivot_longer()</code></strong></a>
  <ul class="collapse">
  <li><a href="#identifying-the-columns-to-pivot" id="toc-identifying-the-columns-to-pivot" class="nav-link" data-scroll-target="#identifying-the-columns-to-pivot"><strong>Identifying the columns to pivot</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#dropping-na-values" id="toc-dropping-na-values" class="nav-link" data-scroll-target="#dropping-na-values"><strong>Dropping <code>NA</code> Values</strong></a></li>
  <li><a href="#pivoting-from-long-to-wide" id="toc-pivoting-from-long-to-wide" class="nav-link" data-scroll-target="#pivoting-from-long-to-wide"><strong>Pivoting from Long-to-wide</strong></a>
  <ul class="collapse">
  <li><a href="#pivoting-using-tidyrpivot_wider" id="toc-pivoting-using-tidyrpivot_wider" class="nav-link" data-scroll-target="#pivoting-using-tidyrpivot_wider"><strong>Pivoting using <code>tidyr::pivot_wider()</code></strong></a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><strong>Summary</strong></a></li>
  <li><a href="#session-information" id="toc-session-information" class="nav-link" data-scroll-target="#session-information"><strong>Session Information</strong></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><strong>Transforming Data Frames: Pivoting</strong></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Gabriel I. Cook </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1><strong>Overview</strong></h1>
<p>In this module, we will address converting data frames <strong>from wide to long</strong> and <strong>from long to wide</strong>, especially in service of arranging data frames to be tidy. The functions for making tidy data frames used here are from <strong>{tidyr}</strong>, specifically <code>pivot_longer()</code> and <code>pivot_wider()</code>.</p>
<section id="readings-and-preparation" class="level2">
<h2 class="anchored" data-anchor-id="readings-and-preparation"><strong>Readings and Preparation</strong></h2>
<p><em>Before Class</em>: First, read to familiarize yourself with the concepts rather than master them. I will assume that you attend class with some level of basic understanding of concepts and working of functions. The goal of reading should be to understand and implement code functions as well as support your understanding and help your troubleshooting of problems. This cannot happen if you just read the content without interacting with it, however reading is absolutely essential to being successful during class time. Work through some examples so that you have a good idea of your level of understanding and confidence.</p>
<p><em>Class</em>: In class, some functions and concepts will be introduced and we will practice implementing code through exercises.</p>
</section>
<section id="supplementary-readings-optional" class="level2">
<h2 class="anchored" data-anchor-id="supplementary-readings-optional"><strong>Supplementary Readings (Optional)</strong></h2>
<ul>
<li><a href="https://r4ds.hadley.nz/data-transform">Data Transformation</a></li>
<li><a href="https://www.markhuberdatascience.org/_files/ugd/c2b9b6_543ea42a1ea64e32b4440b34ffd71635.pdf#page=69">Huber: Transforming Data</a></li>
</ul>
</section>
</section>
<section id="libraries" class="level1">
<h1><strong>Libraries</strong></h1>
<ul>
<li><strong>{here}</strong>: 1.0.1: for path management</li>
<li><strong>{dplyr}</strong> 1.1.4: for selecting, filtering, and mutating</li>
<li><strong>{tidyr}</strong> 1.3.0: for transforming/pivoting data frames</li>
<li><strong>{tidyselect}</strong> 1.2.0: for advanced variable selections functions</li>
<li><strong>{tidyverse}</strong> 2.0.0: for the entire tidyverse ecosystem</li>
</ul>
<section id="loading-libraries" class="level2">
<h2 class="anchored" data-anchor-id="loading-libraries"><strong>Loading Libraries</strong></h2>
<p>We will work with a few different libraries for data manipulation. Let’s load them into our work space using <code>library()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyselect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-structure-formats" class="level1">
<h1><strong>Data Structure Formats</strong></h1>
<p>Data stored in tables are 2-dimensional. Some tables can be long and narrow and some can be short and wide even though they may represent the same data.</p>
<p>but take various forms. Sometimes those forms are based on software packages what work with data in a particular way. For example, SPSS prefers data with many column variables whereas R likes files that are long but contain fewer column variables. On other instances, data take on forms because they are easier to save, easier to share with others, or easier to</p>
<p>Tables are a two-dimensional, very used form of storing and preparing data, and this can be done in two ways: wide and long format.</p>
<p>Each format type has both advantages and disadvantages. The purpose of this module is to introduce ways to transform data from one format to another depending on your goal. In most instances, we will focus on long formats that are tidy because R prefers them for plotting and modeling.</p>
<section id="wide-format-data" class="level2">
<h2 class="anchored" data-anchor-id="wide-format-data"><strong>Wide Format Data</strong></h2>
<p>Wide-format data files are likely most familiar to you as they represent the type of data you may see in spreadsheets. In this example,e individuals have values for three different days with days as columns and individuals as rows.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/wide_data_days.png" class="img-fluid figure-img" width="184"></p>
</figure>
</div>
</div>
</div>
<p>Some disadvantages associated with this representation is that unless there is documentation, you would be unsure what the numeric values represent and the three days represent levels of a <code>day</code> variable which is not part of the data file.</p>
</section>
<section id="long-format-data" class="level2">
<h2 class="anchored" data-anchor-id="long-format-data"><strong>Long Format Data</strong></h2>
<p>The same data can be presented in long-format, for which days are aligned in a column along with a variable name, <code>temp</code>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/long_data_days.png" class="img-fluid figure-img" width="157"></p>
</figure>
</div>
</div>
</div>
<p>Some disadvantages of long-format files is that they are long and difficult to search through and they are limited in their ability to represent a merged version of multiple data sets all of which contain different numbers of rows. By contrast, wide-format files can accommodate multiple columns because each column could easily represent an observation and rows could represent unique cases.</p>
</section>
<section id="tidy-data" class="level2">
<h2 class="anchored" data-anchor-id="tidy-data"><strong>Tidy Data</strong></h2>
<p>Characteristics of tidy data:</p>
<ul>
<li>Each variable is its own column</li>
<li>Each observation is its own row.</li>
<li>Each value has its own cell</li>
</ul>
<p>The goal of restructing data will be to create tidy data for with each variable is represented as a column and observations across rows.</p>
</section>
</section>
<section id="creating-sample-data" class="level1">
<h1><strong>Creating Sample Data</strong></h1>
<p>Let’s use <code>tibble::tribble()</code> to create an example data frame containing 7 columns and 4 rows. The column variables and data for “tasks” will be redundant in order to demonstrate examples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>(EXAMPLE <span class="ot">&lt;-</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>name, <span class="sc">~</span><span class="st">`</span><span class="at">2023</span><span class="st">`</span>, <span class="sc">~</span><span class="st">`</span><span class="at">2024</span><span class="st">`</span>, <span class="sc">~</span>task_A, <span class="sc">~</span>task_B, <span class="sc">~</span>tsk1, <span class="sc">~</span>tsk2,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Bill"</span>, <span class="dv">175</span>, <span class="dv">170</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">10</span>, <span class="dv">12</span>, </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Sally"</span>, <span class="dv">120</span>, <span class="dv">135</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">10</span>, <span class="dv">15</span>, </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Jim"</span>, <span class="dv">150</span>, <span class="dv">150</span>, <span class="dv">11</span>, <span class="dv">24</span>, <span class="dv">11</span>, <span class="dv">24</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Sue"</span>, <span class="dv">115</span>, <span class="dv">120</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 7
  name  `2023` `2024` task_A task_B  tsk1  tsk2
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Bill     175    170     10     12    10    12
2 Sally    120    135     10     15    10    15
3 Jim      150    150     11     24    11    24
4 Sue      115    120     NA     NA    NA    NA</code></pre>
</div>
</div>
<p><strong>Note:</strong> Adding parentheses around the assignment as shown above also causes R to print the object in addition to assigning it.</p>
<section id="inspectingtaking-inventory-of-the-data-structure" class="level2">
<h2 class="anchored" data-anchor-id="inspectingtaking-inventory-of-the-data-structure"><strong>Inspecting/Taking Inventory of the Data Structure</strong></h2>
<p>We first need to inspect the data frame structure. Although you can see this from the output above, another way to view the structure of data frames is by using <code>dplyr::glimpse()</code> or <code>base R</code> <code>str()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>EXAMPLE <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4
Columns: 7
$ name   &lt;chr&gt; "Bill", "Sally", "Jim", "Sue"
$ `2023` &lt;dbl&gt; 175, 120, 150, 115
$ `2024` &lt;dbl&gt; 170, 135, 150, 120
$ task_A &lt;dbl&gt; 10, 10, 11, NA
$ task_B &lt;dbl&gt; 12, 15, 24, NA
$ tsk1   &lt;dbl&gt; 10, 10, 11, NA
$ tsk2   &lt;dbl&gt; 12, 15, 24, NA</code></pre>
</div>
</div>
</section>
<section id="inspectingtaking-inventory-of-the-data-structure-1" class="level2">
<h2 class="anchored" data-anchor-id="inspectingtaking-inventory-of-the-data-structure-1"><strong>Inspecting/Taking Inventory of the Data Structure</strong></h2>
<p>We see some variable are character vectors and some are double (numeric) vectors. But what are the variables and what information do the variables represent? Let’s say that you are informed that there are actually 5 variables in this data set, even though there are 7 column vectors.</p>
<p><code>name</code>: the name of the individual <code>year</code>: the years of data measurement collection <code>weight</code>: the weight in pounds at the time (year) of measurement <code>task</code>: the task type (though represented as both <code>"task_"</code> and <code>"tsk"</code>) <code>score</code>: the measurement score on the tasks</p>
<p><strong>Note:</strong> Having ideal documentation about the data file is important for being able to restructure it appropriately. Always create some documentation so that your future self and others know that the data actually represent.</p>
<p>Only the <code>name</code> variable is currently a column. We don’t have variables named <code>year</code>, <code>weight</code>, <code>task</code>, nor <code>score</code>. The measurement times of the repeated measurements (e.g., the numeric years) are currently stored as separate columns. The values of these columns represent the weights of individuals at two points in time. Some of this information would be unclear unless you had the documentation of what the variables were and how they were stored. This is why having good documentation, or requesting such documentation, is important.</p>
<p>In order to make the data tidy, we need to pivot the two year columns so that they are in arranged as a separate column containing. Take notice that stacking the two column vector would result in a vector that is twice as long. The result is a <strong>longer but narrower data frame</strong>. Other times, you may need to take a longer data frame and make it a <strong>shorter but wider data frame</strong>. The verb used to describe this type of transformation is <strong>pivot</strong>.</p>
</section>
</section>
<section id="pivoting-from-wide-to-long" class="level1">
<h1><strong>Pivoting from Wide to Long</strong></h1>
<p>In order to pivot and transform data frames from wide to long or long to wide, we will use the <strong>{tidyr}</strong> library, which would also be loaded as part of the <strong>{tidyverse}</strong> ecosystem.</p>
<p>The function use to pivot from wide to long is aptly named <code>pivot_longer()</code>. Review the <code>help(tidyr::pivotlonger)</code> documentation for more details on the function and parameters. For now, we will look at some key parameters.</p>
<p>The description of the function is that is <em>“lengthens” data, increasing the number of rows and decreasing the number of columns”</em>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_longer</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  data,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  cols,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  ...,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols_vary =</span> <span class="st">"fastest"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="st">"name"</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_prefix =</span> <span class="cn">NULL</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_sep =</span> <span class="cn">NULL</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_pattern =</span> <span class="cn">NULL</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_ptypes =</span> <span class="cn">NULL</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_transform =</span> <span class="cn">NULL</span>,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_repair =</span> <span class="st">"check_unique"</span>,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_to =</span> <span class="st">"value"</span>,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_drop_na =</span> <span class="cn">FALSE</span>,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_ptypes =</span> <span class="cn">NULL</span>,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_transform =</span> <span class="cn">NULL</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Key Parameters/Arguments:</strong></p>
<ul>
<li><code>data</code>: a data frame to pivot (if piped, does not need to be passed)</li>
<li><code>cols</code>: columns to pivot into longer format</li>
<li><code>names_to</code>: a character vector specifying the new column or columns to create from the information stored in the column names of data specified by cols</li>
<li><code>values_to</code>: a string specifying the name of the column to create from the data stored in cell values</li>
</ul>
<p>Let’s first take a look at the function with these parameters.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>EXAMPLE <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span>      Step <span class="dv">1</span>, select the columns to pivot<span class="sc">/</span>move</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span>  Step <span class="dv">2</span>, specify the name of the column to move those columns </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> Step <span class="dv">3</span>, specify the name of the values from those columns </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Next, let’s examine how to pass arguments to the parameters, starting with <code>cols</code>, then <code>names_to</code>, and finally <code>values_to</code>.</p>
<ul>
<li><p><strong><code>cols</code></strong>: Using the <code>cols</code> parameter, you specify the columns of the data frame that you need to fix by pivoting. A nice characteristic is that it operates similar to <code>dplry::select()</code> used for selecting columns from a data frame. You can select your columns in various ways depending on your needs and flexibility.</p>
<ul>
<li><p>by <em>name</em> (e.g., <code>c("name", 2023)</code>;</p></li>
<li><p>by column <em>position</em> in the data frame (e.g., <code>c(1, 3)</code>, <code>c(2:3)</code>);</p></li>
<li><p>by name <em>containing</em> characters using <code>contains()</code> (e.g., <code>contains("_rt")</code>;</p></li>
<li><p>by name <em>starting</em> with characters using <code>starts_with()</code> (e.g., <code>contains("stroop")</code>);</p></li>
<li><p>by matching regular expression patterns using <code>matches()</code> (e.g., <code>matches("\\d+")</code>);</p></li>
<li><p>by <em>NOT</em> their name or position (e.g., using <code>-</code> or <code>!</code>);</p></li>
<li><p>and more …</p></li>
<li><p><strong>Note:</strong> If your columns are numbers, you need to enclose the variable with back ticks (e.g., <code>&lt;column&gt;</code>).</p></li>
</ul></li>
<li><p><strong><code>names_to</code></strong>: the argument(s) passed to <code>values_to</code> needs to be character type, using quotes).</p></li>
<li><p><strong><code>values_to</code></strong>: the argument(s) passed to <code>values_to</code> needs to be character type.</p></li>
</ul>
<section id="pivoting-using-tidyrpivot_longer" class="level2">
<h2 class="anchored" data-anchor-id="pivoting-using-tidyrpivot_longer"><strong>Pivoting using <code>tidyr::pivot_longer()</code></strong></h2>
<p>After establishing what the data frame is and how you need to transform it, we can consider the steps involved to pass the necessary arguments.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>EXAMPLE <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span>      Step <span class="dv">1</span>, select the columns to pivot<span class="sc">/</span>move</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span>  Step <span class="dv">2</span>, specify the name of the column to move those columns </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> Step <span class="dv">3</span>, specify the name of the values from those columns </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Our Pivoting Goal:</strong></p>
<p><strong>Step 1:</strong> <code>cols</code> to pivot from wide to long</p>
<p><strong>Step 2:</strong> <code>names_to</code>: because they are years, make a <code>years</code> variable under which the dates are placed</p>
<p><strong>Step 3:</strong> <code>values_to</code>: because these are weights, make a <code>weight</code> variable under which the individuals weights for years are placed</p>
<section id="identifying-the-columns-to-pivot" class="level3">
<h3 class="anchored" data-anchor-id="identifying-the-columns-to-pivot"><strong>Identifying the columns to pivot</strong></h3>
<p>As mentioned earlier, you can specify <code>cols</code> by their names in a variety of ways depending on your goals.</p>
<section id="specifying-column-position" class="level4">
<h4 class="anchored" data-anchor-id="specifying-column-position"><strong>Specifying column position</strong></h4>
<p>We can specify columns by position in a variety of ways. Options that are commented out are provided for demonstration. You can test them out if you wish.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>EXAMPLE <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,            <span class="co"># by column position </span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cols = c(2:3),       # by column position using c()</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cols = -1,           # by removing a position, or several -c(1, pos, pos)</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cols = !1,           # by NOT position</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"year"</span>, </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"weight"</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 7
  name  task_A task_B  tsk1  tsk2 year  weight
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 Bill      10     12    10    12 2023     175
2 Bill      10     12    10    12 2024     170
3 Sally     10     15    10    15 2023     120
4 Sally     10     15    10    15 2024     135
5 Jim       11     24    11    24 2023     150
6 Jim       11     24    11    24 2024     150
7 Sue       NA     NA    NA    NA 2023     115
8 Sue       NA     NA    NA    NA 2024     120</code></pre>
</div>
</div>
</section>
<section id="specifying-characters" class="level4">
<h4 class="anchored" data-anchor-id="specifying-characters"><strong>Specifying characters</strong></h4>
<p>Variables that contain certain characters can be selected for pivoting using functions from <strong>{tidyselect}</strong> like <code>contains()</code>, <code>starts_with()</code>, <code>ends_with()</code>, and <code>matches()</code>. We will now work through some examples. These functions load as part of <strong>{dplyr}</strong> as well.</p>
<section id="specifying-characters-using-contains" class="level5">
<h5 class="anchored" data-anchor-id="specifying-characters-using-contains"><strong>Specifying characters using <code>contains()</code></strong></h5>
<p>If we select column names that <code>contains()</code> the characters <code>"task"</code>, we will select only the full spelling of the task; <code>"tsk"</code> columns will be skipped.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>EXAMPLE <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"task"</span>),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"task"</span>, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"score"</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 7
  name  `2023` `2024`  tsk1  tsk2 task   score
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 Bill     175    170    10    12 task_A    10
2 Bill     175    170    10    12 task_B    12
3 Sally    120    135    10    15 task_A    10
4 Sally    120    135    10    15 task_B    15
5 Jim      150    150    11    24 task_A    11
6 Jim      150    150    11    24 task_B    24
7 Sue      115    120    NA    NA task_A    NA
8 Sue      115    120    NA    NA task_B    NA</code></pre>
</div>
</div>
<p>We can now see that there are two new column variables in the returned data frame: <code>task</code> and <code>score</code>.</p>
<p>Some variables are not included in the pivot but nevertheless get included in the process. The task variables spelled differently and have a number suffix are replicated across rows but are not created as a new variable. Similarly, the weights for years are replicated across rows for each task but they are not addressed in the pivoting. Variable names are not perfect right now but they will be cleaned up better in examples of advanced pivoting.</p>
<p>As another example, we can select variables containing the underscore, <code>"_"</code>. Because <code>task_A</code> and <code>task_B</code> are the only variables containing underscores, the outcome will be the same.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>EXAMPLE <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"_"</span>),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"task"</span>, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"score"</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 7
  name  `2023` `2024`  tsk1  tsk2 task   score
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 Bill     175    170    10    12 task_A    10
2 Bill     175    170    10    12 task_B    12
3 Sally    120    135    10    15 task_A    10
4 Sally    120    135    10    15 task_B    15
5 Jim      150    150    11    24 task_A    11
6 Jim      150    150    11    24 task_B    24
7 Sue      115    120    NA    NA task_A    NA
8 Sue      115    120    NA    NA task_B    NA</code></pre>
</div>
</div>
</section>
<section id="specifying-characters-using-starts_with" class="level5">
<h5 class="anchored" data-anchor-id="specifying-characters-using-starts_with"><strong>Specifying characters using <code>starts_with()</code></strong></h5>
<p>We can also select variables for the pivot that start or end with certain characters. Notice that <code>task_A</code>, <code>task_B</code>, <code>tsk_1</code>, and <code>tsk_2</code> all begin with the same letter. If we use that letter, the data frame will pivot on all 4 of those columns and use them to create a single column called <code>task</code>. Such an approach is very useful if the task variants represent different tasks. In this case, the letter and number suffix variables are redundant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>EXAMPLE <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"t"</span>),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"task"</span>, </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"score"</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 5
   name  `2023` `2024` task   score
   &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
 1 Bill     175    170 task_A    10
 2 Bill     175    170 task_B    12
 3 Bill     175    170 tsk1      10
 4 Bill     175    170 tsk2      12
 5 Sally    120    135 task_A    10
 6 Sally    120    135 task_B    15
 7 Sally    120    135 tsk1      10
 8 Sally    120    135 tsk2      15
 9 Jim      150    150 task_A    11
10 Jim      150    150 task_B    24
11 Jim      150    150 tsk1      11
12 Jim      150    150 tsk2      24
13 Sue      115    120 task_A    NA
14 Sue      115    120 task_B    NA
15 Sue      115    120 tsk1      NA
16 Sue      115    120 tsk2      NA</code></pre>
</div>
</div>
<p>The logic for using <code>ends_with()</code> works the same way as <code>starts_with()</code>, so examples are not provided.</p>
</section>
</section>
<section id="specifying-pattern-matches" class="level4">
<h4 class="anchored" data-anchor-id="specifying-pattern-matches"><strong>Specifying pattern matches</strong></h4>
<p>The <code>matches()</code> function is excellent for matching patterns by regular expression. When you cannot type literal characters for grabbing columns, you can think about patterns. We see for example that some variables end in letters and some end in numbers. We can certainly use <code>ends_with()</code> and specify the numbers to grab <code>tsk1</code> and <code>tsk2</code> but if there are numerous variables, doing so involves more work. Moreover, if you are dealing with data sets that can change from time to time, the numbers might change. Hard coding the numbers will create errors, for example, when your data frame no longer contains a variable named <code>tsk1</code>.</p>
<p>In such instances, matching patterns is a wonderful solution. Let’s use <code>matches()</code> to select columns that end in digits. The regular expression pattern <code>\\d+</code> stands for one or more of any digit.</p>
<p>So what happens if we use <code>cols = matches("\\d+")</code>?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>EXAMPLE <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">matches</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">d+"</span>),   <span class="co"># by looking for variables pattern of digits</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"task"</span>, </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"score"</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 5
   name  task_A task_B task  score
   &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
 1 Bill      10     12 2023    175
 2 Bill      10     12 2024    170
 3 Bill      10     12 tsk1     10
 4 Bill      10     12 tsk2     12
 5 Sally     10     15 2023    120
 6 Sally     10     15 2024    135
 7 Sally     10     15 tsk1     10
 8 Sally     10     15 tsk2     15
 9 Jim       11     24 2023    150
10 Jim       11     24 2024    150
11 Jim       11     24 tsk1     11
12 Jim       11     24 tsk2     24
13 Sue       NA     NA 2023    115
14 Sue       NA     NA 2024    120
15 Sue       NA     NA tsk1     NA
16 Sue       NA     NA tsk2     NA</code></pre>
</div>
</div>
<p>Well, that kind of worked but the year data that are also included in <code>task</code> because those variables also contained numbers matched by the pattern.</p>
<p>Sure, you could just remove the numbers from the data frame and pivot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>EXAMPLE <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span> ,<span class="dv">3</span>)) <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">matches</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">d+"</span>),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"task"</span>, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"score"</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  name  task_A task_B task  score
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
1 Bill      10     12 tsk1     10
2 Bill      10     12 tsk2     12
3 Sally     10     15 tsk1     10
4 Sally     10     15 tsk2     15
5 Jim       11     24 tsk1     11
6 Jim       11     24 tsk2     24
7 Sue       NA     NA tsk1     NA
8 Sue       NA     NA tsk2     NA</code></pre>
</div>
</div>
<p>The problem here is that the year data is removed. If you don’t need them, then that’s fine but if you do, you need a better solution. Moreover, sometimes you don’t know when you will need a variable so keeping them in the data set is likely a better solution. Let’s figure out how.</p>
</section>
<section id="specifying-pattern-matches-1" class="level4">
<h4 class="anchored" data-anchor-id="specifying-pattern-matches-1"><strong>Specifying pattern matches</strong></h4>
<p>We see that the variables we want also begin with characters. We might decide to approach the problem by looking for matches to character patterns followed by digit patterns. The following two regular expressions will search for different patterns need to solve the problem.</p>
<ul>
<li><code>[a-zA-Z]+</code>: match one or more characters</li>
<li><code>\\d+</code>: match one or more digits</li>
</ul>
<p>The ordering of the patterns will find variable names that begin with characters followed by numbers.</p>
<p>An example matching letters and then digits:</p>
<ul>
<li><code>matches("[a-zA-Z]+\\d+")</code></li>
</ul>
<p>This pattern would match variables that also contain special characters (e.g., <code>"_"</code>, <code>"-"</code>, <code>"&amp;"</code>, <code>"$"</code>, etc.) between the letter and digits as well as characters after the numbers too. If your variables are more complex, you might need some additional patterns but for this example, the pattern should select what we want, which is to the <code>tsk1</code> and <code>tsk2</code> variables only.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>EXAMPLE <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">matches</span>(<span class="st">"[a-zA-Z]+</span><span class="sc">\\</span><span class="st">d+"</span>),   <span class="co"># by looking for variables pattern of digits</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"task"</span>, </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"score"</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 7
  name  `2023` `2024` task_A task_B task  score
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
1 Bill     175    170     10     12 tsk1     10
2 Bill     175    170     10     12 tsk2     12
3 Sally    120    135     10     15 tsk1     10
4 Sally    120    135     10     15 tsk2     15
5 Jim      150    150     11     24 tsk1     11
6 Jim      150    150     11     24 tsk2     24
7 Sue      115    120     NA     NA tsk1     NA
8 Sue      115    120     NA     NA tsk2     NA</code></pre>
</div>
</div>
<p>Great! We now see that only <code>tsk1</code> and <code>tsk2</code> are selected for pivoting, and are dumped into a new variable named <code>task</code> and the values from them are placed in a new variable named <code>score</code>. Again, the values of <code>task</code> are messy but we will address dealing with that issue in advanced pivoting techniques.</p>
</section>
<section id="regular-expression-anchors" class="level4">
<h4 class="anchored" data-anchor-id="regular-expression-anchors"><strong>Regular Expression Anchors</strong></h4>
<p>There are special characters in for regular expressions that will achieve the same as <code>starts_with()</code> and <code>ends_with()</code>.</p>
</section>
<section id="matching-beginning-characters-using-the-caret" class="level4">
<h4 class="anchored" data-anchor-id="matching-beginning-characters-using-the-caret"><strong>Matching Beginning Characters using the Caret <code>^</code></strong></h4>
<p>To see how <code>^</code> works, let’s add another variable that contains characters and then numbers but neither begins with characters nor ends to digits.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>EXAMPLE <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"23abc24z"</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">matches</span>(<span class="st">"^[a-zA-Z]+</span><span class="sc">\\</span><span class="st">d+"</span>),   </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"task"</span>, </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"score"</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 8
  name  `2023` `2024` task_A task_B `23abc24z` task  score
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
1 Bill     175    170     10     12          1 tsk1     10
2 Bill     175    170     10     12          1 tsk2     12
3 Sally    120    135     10     15          1 tsk1     10
4 Sally    120    135     10     15          1 tsk2     15
5 Jim      150    150     11     24          1 tsk1     11
6 Jim      150    150     11     24          1 tsk2     24
7 Sue      115    120     NA     NA          1 tsk1     NA
8 Sue      115    120     NA     NA          1 tsk2     NA</code></pre>
</div>
</div>
<p>You see that variable <code>23abc24z</code> is not included in the pivot. As a result, the variable remains as a column in the data frame. However, it will be included if the matching is not constrained to starting with characters as seen here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>EXAMPLE <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"23abc24z"</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">matches</span>(<span class="st">"[a-zA-Z]+</span><span class="sc">\\</span><span class="st">d+"</span>),   </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"task"</span>, </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"score"</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 7
   name  `2023` `2024` task_A task_B task     score
   &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;
 1 Bill     175    170     10     12 tsk1        10
 2 Bill     175    170     10     12 tsk2        12
 3 Bill     175    170     10     12 23abc24z     1
 4 Sally    120    135     10     15 tsk1        10
 5 Sally    120    135     10     15 tsk2        15
 6 Sally    120    135     10     15 23abc24z     1
 7 Jim      150    150     11     24 tsk1        11
 8 Jim      150    150     11     24 tsk2        24
 9 Jim      150    150     11     24 23abc24z     1
10 Sue      115    120     NA     NA tsk1        NA
11 Sue      115    120     NA     NA tsk2        NA
12 Sue      115    120     NA     NA 23abc24z     1</code></pre>
</div>
</div>
</section>
<section id="matching-ending-characters-using-the-dollar" class="level4">
<h4 class="anchored" data-anchor-id="matching-ending-characters-using-the-dollar"><strong>Matching Ending Characters using the dollar <code>$</code></strong></h4>
<p>To test <code>$</code> for ending patterns, let’s add the same variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>EXAMPLE <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"23abc24z"</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">matches</span>(<span class="st">"[a-zA-Z]+</span><span class="sc">\\</span><span class="st">d+$"</span>),   </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"task"</span>, </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"score"</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 8
  name  `2023` `2024` task_A task_B `23abc24z` task  score
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
1 Bill     175    170     10     12          1 tsk1     10
2 Bill     175    170     10     12          1 tsk2     12
3 Sally    120    135     10     15          1 tsk1     10
4 Sally    120    135     10     15          1 tsk2     15
5 Jim      150    150     11     24          1 tsk1     11
6 Jim      150    150     11     24          1 tsk2     24
7 Sue      115    120     NA     NA          1 tsk1     NA
8 Sue      115    120     NA     NA          1 tsk2     NA</code></pre>
</div>
</div>
<p>Again, you see that variable <code>23abc24z</code> is not included in the pivot. But it will be included if the matching is not constrained to starting with characters as seen here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>EXAMPLE <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"23abc24z"</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">matches</span>(<span class="st">"[a-zA-Z]+</span><span class="sc">\\</span><span class="st">d+"</span>),   </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"task"</span>, </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"score"</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 7
   name  `2023` `2024` task_A task_B task     score
   &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;
 1 Bill     175    170     10     12 tsk1        10
 2 Bill     175    170     10     12 tsk2        12
 3 Bill     175    170     10     12 23abc24z     1
 4 Sally    120    135     10     15 tsk1        10
 5 Sally    120    135     10     15 tsk2        15
 6 Sally    120    135     10     15 23abc24z     1
 7 Jim      150    150     11     24 tsk1        11
 8 Jim      150    150     11     24 tsk2        24
 9 Jim      150    150     11     24 23abc24z     1
10 Sue      115    120     NA     NA tsk1        NA
11 Sue      115    120     NA     NA tsk2        NA
12 Sue      115    120     NA     NA 23abc24z     1</code></pre>
</div>
</div>
</section>
<section id="matching-beginning-and-ending-characters" class="level4">
<h4 class="anchored" data-anchor-id="matching-beginning-and-ending-characters"><strong>Matching Beginning and Ending Characters</strong></h4>
<p>Using the two anchors together <code>^...$</code> is useful to test whether or not a string fully matches the pattern. We can also add the same variable as before to examine the impact.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>EXAMPLE <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"23abc24z"</span> <span class="ot">=</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">matches</span>(<span class="st">"^[a-zA-Z]+</span><span class="sc">\\</span><span class="st">d+$"</span>),   </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"task"</span>, </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"score"</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 8
  name  `2023` `2024` task_A task_B `23abc24z` task  score
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
1 Bill     175    170     10     12          1 tsk1     10
2 Bill     175    170     10     12          1 tsk2     12
3 Sally    120    135     10     15          1 tsk1     10
4 Sally    120    135     10     15          1 tsk2     15
5 Jim      150    150     11     24          1 tsk1     11
6 Jim      150    150     11     24          1 tsk2     24
7 Sue      115    120     NA     NA          1 tsk1     NA
8 Sue      115    120     NA     NA          1 tsk2     NA</code></pre>
</div>
</div>
<p>Again, <code>23abc24z</code>is not included because of the strict pattern match.</p>
</section>
</section>
</section>
</section>
<section id="dropping-na-values" class="level1">
<h1><strong>Dropping <code>NA</code> Values</strong></h1>
<p>When you pivot, rows containing <code>NA</code> values in the columns selected by <code>cols</code> will become rows of <code>NA</code>s also in the <code>values_to</code> variable as seen in this example.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>EXAMPLE <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"task"</span>),</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"task"</span>, </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"score"</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 7
  name  `2023` `2024`  tsk1  tsk2 task   score
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 Bill     175    170    10    12 task_A    10
2 Bill     175    170    10    12 task_B    12
3 Sally    120    135    10    15 task_A    10
4 Sally    120    135    10    15 task_B    15
5 Jim      150    150    11    24 task_A    11
6 Jim      150    150    11    24 task_B    24
7 Sue      115    120    NA    NA task_A    NA
8 Sue      115    120    NA    NA task_B    NA</code></pre>
</div>
</div>
<p>Sue contains no data for the levels of the <code>task</code> variable, which is seen here by the <code>NA</code>s in the rows for the <code>values_to</code> column <code>score</code>.</p>
<p><code>pivot_longer()</code> has a parameter (e.g., <code>values_drop_na</code>) for removing missing values from the <code>values_to</code> variable column. When setting <code>values_drop_na = TRUE</code>, the rows containing <code>NA</code>s for rows <code>values_to</code> column. As you see in this example, Sue is dropped as a row from the data set because she has <code>NA</code>s for the two tasks.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>EXAMPLE <span class="sc">|&gt;</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"task"</span>),</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"task"</span>, </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"score"</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_drop_na =</span> <span class="cn">TRUE</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  name  `2023` `2024`  tsk1  tsk2 task   score
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 Bill     175    170    10    12 task_A    10
2 Bill     175    170    10    12 task_B    12
3 Sally    120    135    10    15 task_A    10
4 Sally    120    135    10    15 task_B    15
5 Jim      150    150    11    24 task_A    11
6 Jim      150    150    11    24 task_B    24</code></pre>
</div>
</div>
</section>
<section id="pivoting-from-long-to-wide" class="level1">
<h1><strong>Pivoting from Long-to-wide</strong></h1>
<p>Let’s use the same data set but now pivot it back to it’s original structure. Make the the long version an object to work with.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>(LONG <span class="ot">&lt;-</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  EXAMPLE <span class="sc">|&gt;</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">matches</span>(<span class="st">"^[a-zA-Z]+</span><span class="sc">\\</span><span class="st">d+$"</span>),   </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"task"</span>, </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"score"</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 7
  name  `2023` `2024` task_A task_B task  score
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
1 Bill     175    170     10     12 tsk1     10
2 Bill     175    170     10     12 tsk2     12
3 Sally    120    135     10     15 tsk1     10
4 Sally    120    135     10     15 tsk2     15
5 Jim      150    150     11     24 tsk1     11
6 Jim      150    150     11     24 tsk2     24
7 Sue      115    120     NA     NA tsk1     NA
8 Sue      115    120     NA     NA tsk2     NA</code></pre>
</div>
</div>
<section id="pivoting-using-tidyrpivot_wider" class="level2">
<h2 class="anchored" data-anchor-id="pivoting-using-tidyrpivot_wider"><strong>Pivoting using <code>tidyr::pivot_wider()</code></strong></h2>
<p>The help documentation describes that the function <em>‘“widens” data, increasing the number of columns and decreasing the number of rows’</em>.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_wider</span>(</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  data,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  ...,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">id_cols =</span> <span class="cn">NULL</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">id_expand =</span> <span class="cn">FALSE</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_from =</span> name,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_prefix =</span> <span class="st">""</span>,</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_sep =</span> <span class="st">"_"</span>,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_glue =</span> <span class="cn">NULL</span>,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_sort =</span> <span class="cn">FALSE</span>,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_vary =</span> <span class="st">"fastest"</span>,</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_expand =</span> <span class="cn">FALSE</span>,</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_repair =</span> <span class="st">"check_unique"</span>,</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_from =</span> value,</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_fill =</span> <span class="cn">NULL</span>,</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_fn =</span> <span class="cn">NULL</span>,</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">unused_fn =</span> <span class="cn">NULL</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Key Parameters/Arguments:</strong></p>
<ul>
<li><code>data</code>: a data frame to pivot (if piped, does not need to be passed)</li>
<li><code>id_cols</code>: columns to pivot into longer format</li>
<li><code>names_from</code>, <code>values_from</code>: a pair of arguments describing which column (or columns) to get the name of the output column (names_from), and which column (or columns) to get the cell values from (values_from)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>LONG <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> task, </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> score</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>              )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 7
  name  `2023` `2024` task_A task_B  tsk1  tsk2
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Bill     175    170     10     12    10    12
2 Sally    120    135     10     15    10    15
3 Jim      150    150     11     24    11    24
4 Sue      115    120     NA     NA    NA    NA</code></pre>
</div>
</div>
<p>Adding <code>names_prefix = "vocab_"</code> will append ‘vocab’ to the variable name, which reminds us that the task was a vocabulary task.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>LONG <span class="sc">|&gt;</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> task, </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> score,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_prefix =</span> <span class="st">"vocab_"</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>              )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 7
  name  `2023` `2024` task_A task_B vocab_tsk1 vocab_tsk2
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
1 Bill     175    170     10     12         10         12
2 Sally    120    135     10     15         10         15
3 Jim      150    150     11     24         11         24
4 Sue      115    120     NA     NA         NA         NA</code></pre>
</div>
</div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Because we provided the special character `.value` sentinel in the `names_to` argument, we do not have to specify a `values_to` argument and the value column will be derived from the existing column (HRmin, HRmax). In order to do that, we have to specify the `names_sep` argument in the function and specify how we want to split up the column names.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="summary" class="level1">
<h1><strong>Summary</strong></h1>
<p>Data sets are not always going to be formatted the way you want them to be. When they are not, you will need to restructure them so that you can work with them as needed. The pivot functions will be very useful here. Keep in mind that there are advantages and disadvantages associated with both long and wide formats.</p>
<p>Long-format data files benefit from being easier to add additional variables to or to join with other tables. They also are in the format that plotting libraries like <strong>{ggplot2}</strong> and software like Tableau prefer. Disadvantage, however, include difficulty <em>seeing</em> all data in spreadsheet and can be more difficult to reconcile when merged with other tables that contain different</p>
<p>Wide-format data files benefit from presenting data in a way that is easily searchable and do not contain redundant rows being easier to add additional variables that don’t have multiple values to appear on rows. Wide files are also challenged by not being in a format that is favorable for certain software.</p>
</section>
<section id="session-information" class="level1">
<h1><strong>Session Information</strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.2 (2023-10-31 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 11 x64 (build 22621)

Matrix products: default


locale:
[1] LC_COLLATE=English_United States.utf8 
[2] LC_CTYPE=English_United States.utf8   
[3] LC_MONETARY=English_United States.utf8
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.utf8    

time zone: America/Los_Angeles
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices datasets  utils     methods   base     

other attached packages:
[1] tidyselect_1.2.0 tidyr_1.3.0      dplyr_1.1.4     

loaded via a namespace (and not attached):
 [1] jsonlite_1.8.7      compiler_4.3.2      BiocManager_1.30.22
 [4] renv_1.0.3          webshot_0.5.5       callr_3.7.3        
 [7] png_0.1-8           yaml_2.3.7          fastmap_1.1.1      
[10] here_1.0.1          R6_2.5.1            generics_0.1.3     
[13] knitr_1.45          htmlwidgets_1.6.4   tibble_3.2.1       
[16] rprojroot_2.0.3     pillar_1.9.0        R.utils_2.12.2     
[19] rlang_1.1.1         utf8_1.2.4          xfun_0.40          
[22] cli_3.6.1           withr_2.5.0         magrittr_2.0.3     
[25] ps_1.7.5            digest_0.6.33       processx_3.8.2     
[28] rstudioapi_0.15.0   lifecycle_1.0.3     R.methodsS3_1.8.2  
[31] R.oo_1.25.0         vctrs_0.6.5         evaluate_0.21      
[34] glue_1.6.2          fansi_1.0.4         rmarkdown_2.25     
[37] purrr_1.0.2         tools_4.3.2         pkgconfig_2.0.3    
[40] htmltools_0.5.7    </code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>